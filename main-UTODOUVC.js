import{$ as ve,A as De,Aa as On,B as Ae,Ba as Pn,C as f,D as o,Da as It,E as a,F as I,Fa as q,G as k,Ga as Dn,H as x,Ha as kt,I as h,J as gt,K as bt,L as pi,M as c,N as y,O as E,P as K,Q as L,R as j,S as F,T as vt,U as fn,V as mi,W as hi,X as fi,Y as _t,Z as gn,_ as bn,a as sn,aa as xt,b as cn,ba as ne,c as g,ca as _e,d as ln,da as vn,e as Ge,ea as H,f as dn,fa as _n,g as un,ga as W,h as pn,ha as xn,i as Z,ia as yn,j as ht,ja as yt,k as V,ka as Ct,l as b,la as Cn,m as v,ma as wn,n as R,na as En,o as ie,oa as Sn,p as mn,pa as wt,q as M,r as hn,ra as Et,s as l,sa as In,t as O,ta as kn,u as D,ua as St,v as S,va as Mn,w as ui,x as $,y as z,ya as Tn,z as ft,za as Nn}from"./chunk-ZBASSBQY.js";var qn=g((md,gi)=>{"use strict";global.crypto&&global.crypto.getRandomValues?gi.exports.randomBytes=function(i){var t=new Uint8Array(i);return global.crypto.getRandomValues(t),t}:gi.exports.randomBytes=function(i){for(var t=new Array(i),e=0;e<i;e++)t[e]=Math.floor(Math.random()*256);return t}});var Ee=g((hd,Rn)=>{"use strict";var Na=qn(),Vn="abcdefghijklmnopqrstuvwxyz012345";Rn.exports={string:function(i){for(var t=Vn.length,e=Na.randomBytes(i),n=[],r=0;r<i;r++)n.push(Vn.substr(e[r]%t,1));return n.join("")},number:function(i){return Math.floor(Math.random()*i)},numberString:function(i){var t=(""+(i-1)).length,e=new Array(t+1).join("0");return(e+this.number(i)).slice(-t)}}});var de=g((fd,Pt)=>{"use strict";var Oa=Ee(),Re={},bi=!1,Ln=global.chrome&&global.chrome.app&&global.chrome.app.runtime;Pt.exports={attachEvent:function(i,t){typeof global.addEventListener<"u"?global.addEventListener(i,t,!1):global.document&&global.attachEvent&&(global.document.attachEvent("on"+i,t),global.attachEvent("on"+i,t))},detachEvent:function(i,t){typeof global.addEventListener<"u"?global.removeEventListener(i,t,!1):global.document&&global.detachEvent&&(global.document.detachEvent("on"+i,t),global.detachEvent("on"+i,t))},unloadAdd:function(i){if(Ln)return null;var t=Oa.string(8);return Re[t]=i,bi&&setTimeout(this.triggerUnloadCallbacks,0),t},unloadDel:function(i){i in Re&&delete Re[i]},triggerUnloadCallbacks:function(){for(var i in Re)Re[i](),delete Re[i]}};var Pa=function(){bi||(bi=!0,Pt.exports.triggerUnloadCallbacks())};Ln||Pt.exports.attachEvent("unload",Pa)});var Fn=g((gd,jn)=>{"use strict";jn.exports=function(t,e){if(e=e.split(":")[0],t=+t,!t)return!1;switch(e){case"http":case"ws":return t!==80;case"https":case"wss":return t!==443;case"ftp":return t!==21;case"gopher":return t!==70;case"file":return!1}return t!==0}});var Un=g(vi=>{"use strict";var Da=Object.prototype.hasOwnProperty,Aa;function Hn(i){try{return decodeURIComponent(i.replace(/\+/g," "))}catch{return null}}function Wn(i){try{return encodeURIComponent(i)}catch{return null}}function qa(i){for(var t=/([^=?#&]+)=?([^&]*)/g,e={},n;n=t.exec(i);){var r=Hn(n[1]),s=Hn(n[2]);r===null||s===null||r in e||(e[r]=s)}return e}function Va(i,t){t=t||"";var e=[],n,r;typeof t!="string"&&(t="?");for(r in i)if(Da.call(i,r)){if(n=i[r],!n&&(n===null||n===Aa||isNaN(n))&&(n=""),r=Wn(r),n=Wn(n),r===null||n===null)continue;e.push(r+"="+n)}return e.length?t+e.join("&"):""}vi.stringify=Va;vi.parse=qa});var yi=g((vd,Zn)=>{"use strict";var $n=Fn(),Dt=Un(),Ra=/^[\x00-\x20\u00a0\u1680\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]+/,zn=/[\n\r\t]/g,La=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,Gn=/:\d+$/,ja=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\\/]+)?([\S\s]*)/i,Fa=/^[a-zA-Z]:/;function xi(i){return(i||"").toString().replace(Ra,"")}var _i=[["#","hash"],["?","query"],function(t,e){return re(e.protocol)?t.replace(/\\/g,"/"):t},["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d*)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],Bn={hash:1,query:1};function Xn(i){var t;typeof window<"u"?t=window:typeof global<"u"?t=global:typeof self<"u"?t=self:t={};var e=t.location||{};i=i||e;var n={},r=typeof i,s;if(i.protocol==="blob:")n=new oe(unescape(i.pathname),{});else if(r==="string"){n=new oe(i,{});for(s in Bn)delete n[s]}else if(r==="object"){for(s in i)s in Bn||(n[s]=i[s]);n.slashes===void 0&&(n.slashes=La.test(i.href))}return n}function re(i){return i==="file:"||i==="ftp:"||i==="http:"||i==="https:"||i==="ws:"||i==="wss:"}function Jn(i,t){i=xi(i),i=i.replace(zn,""),t=t||{};var e=ja.exec(i),n=e[1]?e[1].toLowerCase():"",r=!!e[2],s=!!e[3],d=0,u;return r?s?(u=e[2]+e[3]+e[4],d=e[2].length+e[3].length):(u=e[2]+e[4],d=e[2].length):s?(u=e[3]+e[4],d=e[3].length):u=e[4],n==="file:"?d>=2&&(u=u.slice(2)):re(n)?u=e[4]:n?r&&(u=u.slice(2)):d>=2&&re(t.protocol)&&(u=e[4]),{protocol:n,slashes:r||re(n),slashesCount:d,rest:u}}function Ha(i,t){if(i==="")return t;for(var e=(t||"/").split("/").slice(0,-1).concat(i.split("/")),n=e.length,r=e[n-1],s=!1,d=0;n--;)e[n]==="."?e.splice(n,1):e[n]===".."?(e.splice(n,1),d++):d&&(n===0&&(s=!0),e.splice(n,1),d--);return s&&e.unshift(""),(r==="."||r==="..")&&e.push(""),e.join("/")}function oe(i,t,e){if(i=xi(i),i=i.replace(zn,""),!(this instanceof oe))return new oe(i,t,e);var n,r,s,d,u,p,_=_i.slice(),T=typeof t,m=this,B=0;for(T!=="object"&&T!=="string"&&(e=t,t=null),e&&typeof e!="function"&&(e=Dt.parse),t=Xn(t),r=Jn(i||"",t),n=!r.protocol&&!r.slashes,m.slashes=r.slashes||n&&t.slashes,m.protocol=r.protocol||t.protocol||"",i=r.rest,(r.protocol==="file:"&&(r.slashesCount!==2||Fa.test(i))||!r.slashes&&(r.protocol||r.slashesCount<2||!re(m.protocol)))&&(_[3]=[/(.*)/,"pathname"]);B<_.length;B++){if(d=_[B],typeof d=="function"){i=d(i,m);continue}s=d[0],p=d[1],s!==s?m[p]=i:typeof s=="string"?(u=s==="@"?i.lastIndexOf(s):i.indexOf(s),~u&&(typeof d[2]=="number"?(m[p]=i.slice(0,u),i=i.slice(u+d[2])):(m[p]=i.slice(u),i=i.slice(0,u)))):(u=s.exec(i))&&(m[p]=u[1],i=i.slice(0,u.index)),m[p]=m[p]||n&&d[3]&&t[p]||"",d[4]&&(m[p]=m[p].toLowerCase())}e&&(m.query=e(m.query)),n&&t.slashes&&m.pathname.charAt(0)!=="/"&&(m.pathname!==""||t.pathname!=="")&&(m.pathname=Ha(m.pathname,t.pathname)),m.pathname.charAt(0)!=="/"&&re(m.protocol)&&(m.pathname="/"+m.pathname),$n(m.port,m.protocol)||(m.host=m.hostname,m.port=""),m.username=m.password="",m.auth&&(u=m.auth.indexOf(":"),~u?(m.username=m.auth.slice(0,u),m.username=encodeURIComponent(decodeURIComponent(m.username)),m.password=m.auth.slice(u+1),m.password=encodeURIComponent(decodeURIComponent(m.password))):m.username=encodeURIComponent(decodeURIComponent(m.auth)),m.auth=m.password?m.username+":"+m.password:m.username),m.origin=m.protocol!=="file:"&&re(m.protocol)&&m.host?m.protocol+"//"+m.host:"null",m.href=m.toString()}function Wa(i,t,e){var n=this;switch(i){case"query":typeof t=="string"&&t.length&&(t=(e||Dt.parse)(t)),n[i]=t;break;case"port":n[i]=t,$n(t,n.protocol)?t&&(n.host=n.hostname+":"+t):(n.host=n.hostname,n[i]="");break;case"hostname":n[i]=t,n.port&&(t+=":"+n.port),n.host=t;break;case"host":n[i]=t,Gn.test(t)?(t=t.split(":"),n.port=t.pop(),n.hostname=t.join(":")):(n.hostname=t,n.port="");break;case"protocol":n.protocol=t.toLowerCase(),n.slashes=!e;break;case"pathname":case"hash":if(t){var r=i==="pathname"?"/":"#";n[i]=t.charAt(0)!==r?r+t:t}else n[i]=t;break;case"username":case"password":n[i]=encodeURIComponent(t);break;case"auth":var s=t.indexOf(":");~s?(n.username=t.slice(0,s),n.username=encodeURIComponent(decodeURIComponent(n.username)),n.password=t.slice(s+1),n.password=encodeURIComponent(decodeURIComponent(n.password))):n.username=encodeURIComponent(decodeURIComponent(t))}for(var d=0;d<_i.length;d++){var u=_i[d];u[4]&&(n[u[1]]=n[u[1]].toLowerCase())}return n.auth=n.password?n.username+":"+n.password:n.username,n.origin=n.protocol!=="file:"&&re(n.protocol)&&n.host?n.protocol+"//"+n.host:"null",n.href=n.toString(),n}function Ua(i){(!i||typeof i!="function")&&(i=Dt.stringify);var t,e=this,n=e.host,r=e.protocol;r&&r.charAt(r.length-1)!==":"&&(r+=":");var s=r+(e.protocol&&e.slashes||re(e.protocol)?"//":"");return e.username?(s+=e.username,e.password&&(s+=":"+e.password),s+="@"):e.password?(s+=":"+e.password,s+="@"):e.protocol!=="file:"&&re(e.protocol)&&!n&&e.pathname!=="/"&&(s+="@"),(n[n.length-1]===":"||Gn.test(e.hostname)&&!e.port)&&(n+=":"),s+=n+e.pathname,t=typeof e.query=="object"?i(e.query):e.query,t&&(s+=t.charAt(0)!=="?"?"?"+t:t),e.hash&&(s+=e.hash),s}oe.prototype={set:Wa,toString:Ua};oe.extractProtocol=Jn;oe.location=Xn;oe.trimLeft=xi;oe.qs=Dt;Zn.exports=oe});var G=g((_d,Kn)=>{"use strict";var Ba=yi(),$a=function(){};Kn.exports={getOrigin:function(i){if(!i)return null;var t=new Ba(i);if(t.protocol==="file:")return null;var e=t.port;return e||(e=t.protocol==="https:"?"443":"80"),t.protocol+"//"+t.hostname+":"+e},isOriginEqual:function(i,t){var e=this.getOrigin(i)===this.getOrigin(t);return $a("same",i,t,e),e},isSchemeEqual:function(i,t){return i.split(":")[0]===t.split(":")[0]},addPath:function(i,t){var e=i.split("?");return e[0]+t+(e[1]?"?"+e[1]:"")},addQuery:function(i,t){return i+(i.indexOf("?")===-1?"?"+t:"&"+t)},isLoopbackAddr:function(i){return/^127\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/i.test(i)||/^\[::1\]$/.test(i)}}});var C=g((xd,Ci)=>{"use strict";typeof Object.create=="function"?Ci.exports=function(t,e){e&&(t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:Ci.exports=function(t,e){if(e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}}});var wi=g((yd,Qn)=>{"use strict";function At(){this._listeners={}}At.prototype.addEventListener=function(i,t){i in this._listeners||(this._listeners[i]=[]);var e=this._listeners[i];e.indexOf(t)===-1&&(e=e.concat([t])),this._listeners[i]=e};At.prototype.removeEventListener=function(i,t){var e=this._listeners[i];if(e){var n=e.indexOf(t);if(n!==-1){e.length>1?this._listeners[i]=e.slice(0,n).concat(e.slice(n+1)):delete this._listeners[i];return}}};At.prototype.dispatchEvent=function(){var i=arguments[0],t=i.type,e=arguments.length===1?[i]:Array.apply(null,arguments);if(this["on"+t]&&this["on"+t].apply(this,e),t in this._listeners)for(var n=this._listeners[t],r=0;r<n.length;r++)n[r].apply(this,e)};Qn.exports=At});var A=g((Cd,Yn)=>{"use strict";var za=C(),qt=wi();function xe(){qt.call(this)}za(xe,qt);xe.prototype.removeAllListeners=function(i){i?delete this._listeners[i]:this._listeners={}};xe.prototype.once=function(i,t){var e=this,n=!1;function r(){e.removeListener(i,r),n||(n=!0,t.apply(this,arguments))}this.on(i,r)};xe.prototype.emit=function(){var i=arguments[0],t=this._listeners[i];if(t){for(var e=arguments.length,n=new Array(e-1),r=1;r<e;r++)n[r-1]=arguments[r];for(var s=0;s<t.length;s++)t[s].apply(this,n)}};xe.prototype.on=xe.prototype.addListener=qt.prototype.addEventListener;xe.prototype.removeListener=qt.prototype.removeEventListener;Yn.exports.EventEmitter=xe});var tr=g((wd,Ei)=>{"use strict";var er=global.WebSocket||global.MozWebSocket;er?Ei.exports=function(t){return new er(t)}:Ei.exports=void 0});var ar=g((Ed,or)=>{"use strict";var ir=de(),Ga=G(),Xa=C(),nr=A().EventEmitter,rr=tr(),ue=function(){};function pe(i,t,e){if(!pe.enabled())throw new Error("Transport created when disabled");nr.call(this),ue("constructor",i);var n=this,r=Ga.addPath(i,"/websocket");r.slice(0,5)==="https"?r="wss"+r.slice(5):r="ws"+r.slice(4),this.url=r,this.ws=new rr(this.url,[],e),this.ws.onmessage=function(s){ue("message event",s.data),n.emit("message",s.data)},this.unloadRef=ir.unloadAdd(function(){ue("unload"),n.ws.close()}),this.ws.onclose=function(s){ue("close event",s.code,s.reason),n.emit("close",s.code,s.reason),n._cleanup()},this.ws.onerror=function(s){ue("error event",s),n.emit("close",1006,"WebSocket connection broken"),n._cleanup()}}Xa(pe,nr);pe.prototype.send=function(i){var t="["+i+"]";ue("send",t),this.ws.send(t)};pe.prototype.close=function(){ue("close");var i=this.ws;this._cleanup(),i&&i.close()};pe.prototype._cleanup=function(){ue("_cleanup");var i=this.ws;i&&(i.onmessage=i.onclose=i.onerror=null),ir.unloadDel(this.unloadRef),this.unloadRef=this.ws=null,this.removeAllListeners()};pe.enabled=function(){return ue("enabled"),!!rr};pe.transportName="websocket";pe.roundTrips=2;or.exports=pe});var lr=g((Sd,cr)=>{"use strict";var Ja=C(),sr=A().EventEmitter,me=function(){};function Se(i,t){me(i),sr.call(this),this.sendBuffer=[],this.sender=t,this.url=i}Ja(Se,sr);Se.prototype.send=function(i){me("send",i),this.sendBuffer.push(i),this.sendStop||this.sendSchedule()};Se.prototype.sendScheduleWait=function(){me("sendScheduleWait");var i=this,t;this.sendStop=function(){me("sendStop"),i.sendStop=null,clearTimeout(t)},t=setTimeout(function(){me("timeout"),i.sendStop=null,i.sendSchedule()},25)};Se.prototype.sendSchedule=function(){me("sendSchedule",this.sendBuffer.length);var i=this;if(this.sendBuffer.length>0){var t="["+this.sendBuffer.join(",")+"]";this.sendStop=this.sender(this.url,t,function(e){i.sendStop=null,e?(me("error",e),i.emit("close",e.code||1006,"Sending error: "+e),i.close()):i.sendScheduleWait()}),this.sendBuffer=[]}};Se.prototype._cleanup=function(){me("_cleanup"),this.removeAllListeners()};Se.prototype.close=function(){me("close"),this._cleanup(),this.sendStop&&(this.sendStop(),this.sendStop=null)};cr.exports=Se});var pr=g((Id,ur)=>{"use strict";var Za=C(),dr=A().EventEmitter,Je=function(){};function Vt(i,t,e){Je(t),dr.call(this),this.Receiver=i,this.receiveUrl=t,this.AjaxObject=e,this._scheduleReceiver()}Za(Vt,dr);Vt.prototype._scheduleReceiver=function(){Je("_scheduleReceiver");var i=this,t=this.poll=new this.Receiver(this.receiveUrl,this.AjaxObject);t.on("message",function(e){Je("message",e),i.emit("message",e)}),t.once("close",function(e,n){Je("close",e,n,i.pollIsClosing),i.poll=t=null,i.pollIsClosing||(n==="network"?i._scheduleReceiver():(i.emit("close",e||1006,n),i.removeAllListeners()))})};Vt.prototype.abort=function(){Je("abort"),this.removeAllListeners(),this.pollIsClosing=!0,this.poll&&this.poll.abort()};ur.exports=Vt});var ki=g((kd,mr)=>{"use strict";var Ka=C(),Qa=G(),Si=lr(),Ya=pr(),Rt=function(){};function Ii(i,t,e,n,r){var s=Qa.addPath(i,t);Rt(s);var d=this;Si.call(this,i,e),this.poll=new Ya(n,s,r),this.poll.on("message",function(u){Rt("poll message",u),d.emit("message",u)}),this.poll.once("close",function(u,p){Rt("poll close",u,p),d.poll=null,d.emit("close",u,p),d.close()})}Ka(Ii,Si);Ii.prototype.close=function(){Si.prototype.close.call(this),Rt("close"),this.removeAllListeners(),this.poll&&(this.poll.abort(),this.poll=null)};mr.exports=Ii});var Ie=g((Md,gr)=>{"use strict";var es=C(),ts=G(),hr=ki(),Mi=function(){};function is(i){return function(t,e,n){Mi("create ajax sender",t,e);var r={};typeof e=="string"&&(r.headers={"Content-type":"text/plain"});var s=ts.addPath(t,"/xhr_send"),d=new i("POST",s,e,r);return d.once("finish",function(u){if(Mi("finish",u),d=null,u!==200&&u!==204)return n(new Error("http status "+u));n()}),function(){Mi("abort"),d.close(),d=null;var u=new Error("Aborted");u.code=1e3,n(u)}}}function fr(i,t,e,n){hr.call(this,i,t,is(n),e,n)}es(fr,hr);gr.exports=fr});var Ke=g((Td,vr)=>{"use strict";var ns=C(),br=A().EventEmitter,ye=function(){};function Ze(i,t){ye(i),br.call(this);var e=this;this.bufferPosition=0,this.xo=new t("POST",i,null),this.xo.on("chunk",this._chunkHandler.bind(this)),this.xo.once("finish",function(n,r){ye("finish",n,r),e._chunkHandler(n,r),e.xo=null;var s=n===200?"network":"permanent";ye("close",s),e.emit("close",null,s),e._cleanup()})}ns(Ze,br);Ze.prototype._chunkHandler=function(i,t){if(ye("_chunkHandler",i),!(i!==200||!t))for(var e=-1;;this.bufferPosition+=e+1){var n=t.slice(this.bufferPosition);if(e=n.indexOf(`
`),e===-1)break;var r=n.slice(0,e);r&&(ye("message",r),this.emit("message",r))}};Ze.prototype._cleanup=function(){ye("_cleanup"),this.removeAllListeners()};Ze.prototype.abort=function(){ye("abort"),this.xo&&(this.xo.close(),ye("close"),this.emit("close",null,"user"),this.xo=null),this._cleanup()};vr.exports=Ze});var Ti=g((Nd,wr)=>{"use strict";var xr=A().EventEmitter,rs=C(),yr=de(),os=G(),Qe=global.XMLHttpRequest,U=function(){};function ae(i,t,e,n){U(i,t);var r=this;xr.call(this),setTimeout(function(){r._start(i,t,e,n)},0)}rs(ae,xr);ae.prototype._start=function(i,t,e,n){var r=this;try{this.xhr=new Qe}catch{}if(!this.xhr){U("no xhr"),this.emit("finish",0,"no xhr support"),this._cleanup();return}t=os.addQuery(t,"t="+ +new Date),this.unloadRef=yr.unloadAdd(function(){U("unload cleanup"),r._cleanup(!0)});try{this.xhr.open(i,t,!0),this.timeout&&"timeout"in this.xhr&&(this.xhr.timeout=this.timeout,this.xhr.ontimeout=function(){U("xhr timeout"),r.emit("finish",0,""),r._cleanup(!1)})}catch(d){U("exception",d),this.emit("finish",0,""),this._cleanup(!1);return}if((!n||!n.noCredentials)&&ae.supportsCORS&&(U("withCredentials"),this.xhr.withCredentials=!0),n&&n.headers)for(var s in n.headers)this.xhr.setRequestHeader(s,n.headers[s]);this.xhr.onreadystatechange=function(){if(r.xhr){var d=r.xhr,u,p;switch(U("readyState",d.readyState),d.readyState){case 3:try{p=d.status,u=d.responseText}catch{}U("status",p),p===1223&&(p=204),p===200&&u&&u.length>0&&(U("chunk"),r.emit("chunk",p,u));break;case 4:p=d.status,U("status",p),p===1223&&(p=204),(p===12005||p===12029)&&(p=0),U("finish",p,d.responseText),r.emit("finish",p,d.responseText),r._cleanup(!1);break}}};try{r.xhr.send(e)}catch{r.emit("finish",0,""),r._cleanup(!1)}};ae.prototype._cleanup=function(i){if(U("cleanup"),!!this.xhr){if(this.removeAllListeners(),yr.unloadDel(this.unloadRef),this.xhr.onreadystatechange=function(){},this.xhr.ontimeout&&(this.xhr.ontimeout=null),i)try{this.xhr.abort()}catch{}this.unloadRef=this.xhr=null}};ae.prototype.close=function(){U("close"),this._cleanup(!0)};ae.enabled=!!Qe;var _r=["Active"].concat("Object").join("X");!ae.enabled&&_r in global&&(U("overriding xmlhttprequest"),Qe=function(){try{return new global[_r]("Microsoft.XMLHTTP")}catch{return null}},ae.enabled=!!new Qe);var Cr=!1;try{Cr="withCredentials"in new Qe}catch{}ae.supportsCORS=Cr;wr.exports=ae});var Ye=g((Od,Er)=>{"use strict";var as=C(),Lt=Ti();function Ni(i,t,e,n){Lt.call(this,i,t,e,n)}as(Ni,Lt);Ni.enabled=Lt.enabled&&Lt.supportsCORS;Er.exports=Ni});var Le=g((Pd,Sr)=>{"use strict";var ss=C(),Oi=Ti();function Pi(i,t,e){Oi.call(this,i,t,e,{noCredentials:!0})}ss(Pi,Oi);Pi.enabled=Oi.enabled;Sr.exports=Pi});var je=g((Dd,Ir)=>{"use strict";Ir.exports={isOpera:function(){return global.navigator&&/opera/i.test(global.navigator.userAgent)},isKonqueror:function(){return global.navigator&&/konqueror/i.test(global.navigator.userAgent)},hasDomain:function(){if(!global.document)return!0;try{return!!global.document.domain}catch{return!1}}}});var Tr=g((Ad,Mr)=>{"use strict";var cs=C(),kr=Ie(),ls=Ke(),Di=Ye(),ds=Le(),us=je();function Fe(i){if(!ds.enabled&&!Di.enabled)throw new Error("Transport created when disabled");kr.call(this,i,"/xhr_streaming",ls,Di)}cs(Fe,kr);Fe.enabled=function(i){return i.nullOrigin||us.isOpera()?!1:Di.enabled};Fe.transportName="xhr-streaming";Fe.roundTrips=2;Fe.needBody=!!global.document;Mr.exports=Fe});var jt=g((qd,Pr)=>{"use strict";var Nr=A().EventEmitter,ps=C(),Or=de(),ms=je(),hs=G(),Ce=function(){};function ke(i,t,e){Ce(i,t);var n=this;Nr.call(this),setTimeout(function(){n._start(i,t,e)},0)}ps(ke,Nr);ke.prototype._start=function(i,t,e){Ce("_start");var n=this,r=new global.XDomainRequest;t=hs.addQuery(t,"t="+ +new Date),r.onerror=function(){Ce("onerror"),n._error()},r.ontimeout=function(){Ce("ontimeout"),n._error()},r.onprogress=function(){Ce("progress",r.responseText),n.emit("chunk",200,r.responseText)},r.onload=function(){Ce("load"),n.emit("finish",200,r.responseText),n._cleanup(!1)},this.xdr=r,this.unloadRef=Or.unloadAdd(function(){n._cleanup(!0)});try{this.xdr.open(i,t),this.timeout&&(this.xdr.timeout=this.timeout),this.xdr.send(e)}catch{this._error()}};ke.prototype._error=function(){this.emit("finish",0,""),this._cleanup(!1)};ke.prototype._cleanup=function(i){if(Ce("cleanup",i),!!this.xdr){if(this.removeAllListeners(),Or.unloadDel(this.unloadRef),this.xdr.ontimeout=this.xdr.onerror=this.xdr.onprogress=this.xdr.onload=null,i)try{this.xdr.abort()}catch{}this.unloadRef=this.xdr=null}};ke.prototype.close=function(){Ce("close"),this._cleanup(!0)};ke.enabled=!!(global.XDomainRequest&&ms.hasDomain());Pr.exports=ke});var qi=g((Vd,Ar)=>{"use strict";var fs=C(),Dr=Ie(),gs=Ke(),Ai=jt();function et(i){if(!Ai.enabled)throw new Error("Transport created when disabled");Dr.call(this,i,"/xhr_streaming",gs,Ai)}fs(et,Dr);et.enabled=function(i){return i.cookie_needed||i.nullOrigin?!1:Ai.enabled&&i.sameScheme};et.transportName="xdr-streaming";et.roundTrips=2;Ar.exports=et});var Vi=g((Rd,qr)=>{"use strict";qr.exports=global.EventSource});var Lr=g((Ld,Rr)=>{"use strict";var bs=C(),Vr=A().EventEmitter,vs=Vi(),He=function(){};function tt(i){He(i),Vr.call(this);var t=this,e=this.es=new vs(i);e.onmessage=function(n){He("message",n.data),t.emit("message",decodeURI(n.data))},e.onerror=function(n){He("error",e.readyState,n);var r=e.readyState!==2?"network":"permanent";t._cleanup(),t._close(r)}}bs(tt,Vr);tt.prototype.abort=function(){He("abort"),this._cleanup(),this._close("user")};tt.prototype._cleanup=function(){He("cleanup");var i=this.es;i&&(i.onmessage=i.onerror=null,i.close(),this.es=null)};tt.prototype._close=function(i){He("close",i);var t=this;setTimeout(function(){t.emit("close",null,i),t.removeAllListeners()},200)};Rr.exports=tt});var Ri=g((jd,Fr)=>{"use strict";var _s=C(),jr=Ie(),xs=Lr(),ys=Ye(),Cs=Vi();function We(i){if(!We.enabled())throw new Error("Transport created when disabled");jr.call(this,i,"/eventsource",xs,ys)}_s(We,jr);We.enabled=function(){return!!Cs};We.transportName="eventsource";We.roundTrips=2;Fr.exports=We});var Li=g((Fd,Hr)=>{"use strict";Hr.exports="1.6.1"});var Ue=g((Hd,he)=>{"use strict";var Ft=de(),ws=je(),Me=function(){};he.exports={WPrefix:"_jp",currentWindowId:null,polluteGlobalNamespace:function(){he.exports.WPrefix in global||(global[he.exports.WPrefix]={})},postMessage:function(i,t){global.parent!==global?global.parent.postMessage(JSON.stringify({windowId:he.exports.currentWindowId,type:i,data:t||""}),"*"):Me("Cannot postMessage, no parent window.",i,t)},createIframe:function(i,t){var e=global.document.createElement("iframe"),n,r,s=function(){Me("unattach"),clearTimeout(n);try{e.onload=null}catch{}e.onerror=null},d=function(){Me("cleanup"),e&&(s(),setTimeout(function(){e&&e.parentNode.removeChild(e),e=null},0),Ft.unloadDel(r))},u=function(_){Me("onerror",_),e&&(d(),t(_))},p=function(_,T){Me("post",_,T),setTimeout(function(){try{e&&e.contentWindow&&e.contentWindow.postMessage(_,T)}catch{}},0)};return e.src=i,e.style.display="none",e.style.position="absolute",e.onerror=function(){u("onerror")},e.onload=function(){Me("onload"),clearTimeout(n),n=setTimeout(function(){u("onload timeout")},2e3)},global.document.body.appendChild(e),n=setTimeout(function(){u("timeout")},15e3),r=Ft.unloadAdd(d),{post:p,cleanup:d,loaded:s}},createHtmlfile:function(i,t){var e=["Active"].concat("Object").join("X"),n=new global[e]("htmlfile"),r,s,d,u=function(){clearTimeout(r),d.onerror=null},p=function(){n&&(u(),Ft.unloadDel(s),d.parentNode.removeChild(d),d=n=null,CollectGarbage())},_=function(B){Me("onerror",B),n&&(p(),t(B))},T=function(B,di){try{setTimeout(function(){d&&d.contentWindow&&d.contentWindow.postMessage(B,di)},0)}catch{}};n.open(),n.write('<html><script>document.domain="'+global.document.domain+'";<\/script></html>'),n.close(),n.parentWindow[he.exports.WPrefix]=global[he.exports.WPrefix];var m=n.createElement("div");return n.body.appendChild(m),d=n.createElement("iframe"),m.appendChild(d),d.src=i,d.onerror=function(){_("onerror")},r=setTimeout(function(){_("timeout")},15e3),s=Ft.unloadAdd(p),{post:T,cleanup:p,loaded:u}}};he.exports.iframeEnabled=!1;global.document&&(he.exports.iframeEnabled=(typeof global.postMessage=="function"||typeof global.postMessage=="object")&&!ws.isKonqueror())});var Fi=g((Wd,$r)=>{"use strict";var Es=C(),Wr=A().EventEmitter,Ss=Li(),ji=G(),Ur=Ue(),Br=de(),Is=Ee(),se=function(){};function ce(i,t,e){if(!ce.enabled())throw new Error("Transport created when disabled");Wr.call(this);var n=this;this.origin=ji.getOrigin(e),this.baseUrl=e,this.transUrl=t,this.transport=i,this.windowId=Is.string(8);var r=ji.addPath(e,"/iframe.html")+"#"+this.windowId;se(i,t,r),this.iframeObj=Ur.createIframe(r,function(s){se("err callback"),n.emit("close",1006,"Unable to load an iframe ("+s+")"),n.close()}),this.onmessageCallback=this._message.bind(this),Br.attachEvent("message",this.onmessageCallback)}Es(ce,Wr);ce.prototype.close=function(){if(se("close"),this.removeAllListeners(),this.iframeObj){Br.detachEvent("message",this.onmessageCallback);try{this.postMessage("c")}catch{}this.iframeObj.cleanup(),this.iframeObj=null,this.onmessageCallback=this.iframeObj=null}};ce.prototype._message=function(i){if(se("message",i.data),!ji.isOriginEqual(i.origin,this.origin)){se("not same origin",i.origin,this.origin);return}var t;try{t=JSON.parse(i.data)}catch{se("bad json",i.data);return}if(t.windowId!==this.windowId){se("mismatched window id",t.windowId,this.windowId);return}switch(t.type){case"s":this.iframeObj.loaded(),this.postMessage("s",JSON.stringify([Ss,this.transport,this.transUrl,this.baseUrl]));break;case"t":this.emit("message",t.data);break;case"c":var e;try{e=JSON.parse(t.data)}catch{se("bad json",t.data);return}this.emit("close",e[0],e[1]),this.close();break}};ce.prototype.postMessage=function(i,t){se("postMessage",i,t),this.iframeObj.post(JSON.stringify({windowId:this.windowId,type:i,data:t||""}),this.origin)};ce.prototype.send=function(i){se("send",i),this.postMessage("m",i)};ce.enabled=function(){return Ur.iframeEnabled};ce.transportName="iframe";ce.roundTrips=2;$r.exports=ce});var Ht=g((Ud,zr)=>{"use strict";zr.exports={isObject:function(i){var t=typeof i;return t==="function"||t==="object"&&!!i},extend:function(i){if(!this.isObject(i))return i;for(var t,e,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&(i[e]=t[e])}return i}}});var Ut=g((Bd,Gr)=>{"use strict";var ks=C(),Wt=Fi(),Ms=Ht();Gr.exports=function(i){function t(e,n){Wt.call(this,i.transportName,e,n)}return ks(t,Wt),t.enabled=function(e,n){if(!global.document)return!1;var r=Ms.extend({},n);return r.sameOrigin=!0,i.enabled(r)&&Wt.enabled()},t.transportName="iframe-"+i.transportName,t.needBody=!0,t.roundTrips=Wt.roundTrips+i.roundTrips-1,t.facadeTransport=i,t}});var Kr=g(($d,Zr)=>{"use strict";var Ts=C(),Te=Ue(),Ns=G(),Jr=A().EventEmitter,Os=Ee(),fe=function(){};function ee(i){fe(i),Jr.call(this);var t=this;Te.polluteGlobalNamespace(),this.id="a"+Os.string(6),i=Ns.addQuery(i,"c="+decodeURIComponent(Te.WPrefix+"."+this.id)),fe("using htmlfile",ee.htmlfileEnabled);var e=ee.htmlfileEnabled?Te.createHtmlfile:Te.createIframe;global[Te.WPrefix][this.id]={start:function(){fe("start"),t.iframeObj.loaded()},message:function(n){fe("message",n),t.emit("message",n)},stop:function(){fe("stop"),t._cleanup(),t._close("network")}},this.iframeObj=e(i,function(){fe("callback"),t._cleanup(),t._close("permanent")})}Ts(ee,Jr);ee.prototype.abort=function(){fe("abort"),this._cleanup(),this._close("user")};ee.prototype._cleanup=function(){fe("_cleanup"),this.iframeObj&&(this.iframeObj.cleanup(),this.iframeObj=null),delete global[Te.WPrefix][this.id]};ee.prototype._close=function(i){fe("_close",i),this.emit("close",null,i),this.removeAllListeners()};ee.htmlfileEnabled=!1;var Xr=["Active"].concat("Object").join("X");if(Xr in global)try{ee.htmlfileEnabled=!!new global[Xr]("htmlfile")}catch{}ee.enabled=ee.htmlfileEnabled||Te.iframeEnabled;Zr.exports=ee});var Wi=g((zd,Yr)=>{"use strict";var Ps=C(),Hi=Kr(),Ds=Le(),Qr=Ie();function it(i){if(!Hi.enabled)throw new Error("Transport created when disabled");Qr.call(this,i,"/htmlfile",Hi,Ds)}Ps(it,Qr);it.enabled=function(i){return Hi.enabled&&i.sameOrigin};it.transportName="htmlfile";it.roundTrips=2;Yr.exports=it});var Bi=g((Gd,io)=>{"use strict";var As=C(),eo=Ie(),qs=Ke(),Ui=Ye(),to=Le();function nt(i){if(!to.enabled&&!Ui.enabled)throw new Error("Transport created when disabled");eo.call(this,i,"/xhr",qs,Ui)}As(nt,eo);nt.enabled=function(i){return i.nullOrigin?!1:to.enabled&&i.sameOrigin?!0:Ui.enabled};nt.transportName="xhr-polling";nt.roundTrips=2;io.exports=nt});var ao=g((Xd,oo)=>{"use strict";var Vs=C(),ro=Ie(),Rs=qi(),Ls=Ke(),no=jt();function rt(i){if(!no.enabled)throw new Error("Transport created when disabled");ro.call(this,i,"/xhr",Ls,no)}Vs(rt,ro);rt.enabled=Rs.enabled;rt.transportName="xdr-polling";rt.roundTrips=2;oo.exports=rt});var uo=g((Jd,lo)=>{"use strict";var ot=Ue(),so=Ee(),js=je(),Fs=G(),Hs=C(),co=A().EventEmitter,te=function(){};function Q(i){te(i);var t=this;co.call(this),ot.polluteGlobalNamespace(),this.id="a"+so.string(6);var e=Fs.addQuery(i,"c="+encodeURIComponent(ot.WPrefix+"."+this.id));global[ot.WPrefix][this.id]=this._callback.bind(this),this._createScript(e),this.timeoutId=setTimeout(function(){te("timeout"),t._abort(new Error("JSONP script loaded abnormally (timeout)"))},Q.timeout)}Hs(Q,co);Q.prototype.abort=function(){if(te("abort"),global[ot.WPrefix][this.id]){var i=new Error("JSONP user aborted read");i.code=1e3,this._abort(i)}};Q.timeout=35e3;Q.scriptErrorTimeout=1e3;Q.prototype._callback=function(i){te("_callback",i),this._cleanup(),!this.aborting&&(i&&(te("message",i),this.emit("message",i)),this.emit("close",null,"network"),this.removeAllListeners())};Q.prototype._abort=function(i){te("_abort",i),this._cleanup(),this.aborting=!0,this.emit("close",i.code,i.message),this.removeAllListeners()};Q.prototype._cleanup=function(){if(te("_cleanup"),clearTimeout(this.timeoutId),this.script2&&(this.script2.parentNode.removeChild(this.script2),this.script2=null),this.script){var i=this.script;i.parentNode.removeChild(i),i.onreadystatechange=i.onerror=i.onload=i.onclick=null,this.script=null}delete global[ot.WPrefix][this.id]};Q.prototype._scriptError=function(){te("_scriptError");var i=this;this.errorTimer||(this.errorTimer=setTimeout(function(){i.loadedOkay||i._abort(new Error("JSONP script loaded abnormally (onerror)"))},Q.scriptErrorTimeout))};Q.prototype._createScript=function(i){te("_createScript",i);var t=this,e=this.script=global.document.createElement("script"),n;if(e.id="a"+so.string(8),e.src=i,e.type="text/javascript",e.charset="UTF-8",e.onerror=this._scriptError.bind(this),e.onload=function(){te("onload"),t._abort(new Error("JSONP script loaded abnormally (onload)"))},e.onreadystatechange=function(){if(te("onreadystatechange",e.readyState),/loaded|closed/.test(e.readyState)){if(e&&e.htmlFor&&e.onclick){t.loadedOkay=!0;try{e.onclick()}catch{}}e&&t._abort(new Error("JSONP script loaded abnormally (onreadystatechange)"))}},typeof e.async>"u"&&global.document.attachEvent)if(js.isOpera())n=this.script2=global.document.createElement("script"),n.text="try{var a = document.getElementById('"+e.id+"'); if(a)a.onerror();}catch(x){};",e.async=n.async=!1;else{try{e.htmlFor=e.id,e.event="onclick"}catch{}e.async=!0}typeof e.async<"u"&&(e.async=!0);var r=global.document.getElementsByTagName("head")[0];r.insertBefore(e,r.firstChild),n&&r.insertBefore(n,r.firstChild)};lo.exports=Q});var ho=g((Zd,mo)=>{"use strict";var Ws=Ee(),po=G(),ge=function(){},X,at;function Us(i){ge("createIframe",i);try{return global.document.createElement('<iframe name="'+i+'">')}catch{var t=global.document.createElement("iframe");return t.name=i,t}}function Bs(){ge("createForm"),X=global.document.createElement("form"),X.style.display="none",X.style.position="absolute",X.method="POST",X.enctype="application/x-www-form-urlencoded",X.acceptCharset="UTF-8",at=global.document.createElement("textarea"),at.name="d",X.appendChild(at),global.document.body.appendChild(X)}mo.exports=function(i,t,e){ge(i,t),X||Bs();var n="a"+Ws.string(8);X.target=n,X.action=po.addQuery(po.addPath(i,"/jsonp_send"),"i="+n);var r=Us(n);r.id=n,r.style.display="none",X.appendChild(r);try{at.value=t}catch{}X.submit();var s=function(d){ge("completed",n,d),r.onerror&&(r.onreadystatechange=r.onerror=r.onload=null,setTimeout(function(){ge("cleaning up",n),r.parentNode.removeChild(r),r=null},500),at.value="",e(d))};return r.onerror=function(){ge("onerror",n),s()},r.onload=function(){ge("onload",n),s()},r.onreadystatechange=function(d){ge("onreadystatechange",n,r.readyState,d),r.readyState==="complete"&&s()},function(){ge("aborted",n),s(new Error("Aborted"))}}});var bo=g((Kd,go)=>{"use strict";var $s=C(),fo=ki(),zs=uo(),Gs=ho();function Ne(i){if(!Ne.enabled())throw new Error("Transport created when disabled");fo.call(this,i,"/jsonp",Gs,zs)}$s(Ne,fo);Ne.enabled=function(){return!!global.document};Ne.transportName="jsonp-polling";Ne.roundTrips=1;Ne.needBody=!0;go.exports=Ne});var _o=g((Qd,vo)=>{"use strict";vo.exports=[ar(),Tr(),qi(),Ri(),Ut()(Ri()),Wi(),Ut()(Wi()),Bi(),ao(),Ut()(Bi()),bo()]});var Io=g(()=>{"use strict";var st=Array.prototype,Xi=Object.prototype,Xs=Function.prototype,ct=String.prototype,$i=st.slice,Ji=Xi.toString,Co=function(i){return Xi.toString.call(i)==="[object Function]"},Js=function(t){return Ji.call(t)==="[object Array]"},wo=function(t){return Ji.call(t)==="[object String]"},Zs=Object.defineProperty&&(function(){try{return Object.defineProperty({},"x",{}),!0}catch{return!1}})(),Gi;Zs?Gi=function(i,t,e,n){!n&&t in i||Object.defineProperty(i,t,{configurable:!0,enumerable:!1,writable:!0,value:e})}:Gi=function(i,t,e,n){!n&&t in i||(i[t]=e)};var lt=function(i,t,e){for(var n in t)Xi.hasOwnProperty.call(t,n)&&Gi(i,n,t[n],e)},Eo=function(i){if(i==null)throw new TypeError("can't convert "+i+" to object");return Object(i)};function Ks(i){var t=+i;return t!==t?t=0:t!==0&&t!==1/0&&t!==-1/0&&(t=(t>0||-1)*Math.floor(Math.abs(t))),t}function Qs(i){return i>>>0}function zi(){}lt(Xs,{bind:function(t){var e=this;if(!Co(e))throw new TypeError("Function.prototype.bind called on incompatible "+e);for(var n=$i.call(arguments,1),r=function(){if(this instanceof p){var _=e.apply(this,n.concat($i.call(arguments)));return Object(_)===_?_:this}else return e.apply(t,n.concat($i.call(arguments)))},s=Math.max(0,e.length-n.length),d=[],u=0;u<s;u++)d.push("$"+u);var p=Function("binder","return function ("+d.join(",")+"){ return binder.apply(this, arguments); }")(r);return e.prototype&&(zi.prototype=e.prototype,p.prototype=new zi,zi.prototype=null),p}});lt(Array,{isArray:Js});var xo=Object("a"),So=xo[0]!=="a"||!(0 in xo),Ys=function(t){var e=!0,n=!0;return t&&(t.call("foo",function(r,s,d){typeof d!="object"&&(e=!1)}),t.call([1],function(){"use strict";n=typeof this=="string"},"x")),!!t&&e&&n};lt(st,{forEach:function(t){var e=Eo(this),n=So&&wo(this)?this.split(""):e,r=arguments[1],s=-1,d=n.length>>>0;if(!Co(t))throw new TypeError;for(;++s<d;)s in n&&t.call(r,n[s],s,e)}},!Ys(st.forEach));var ec=Array.prototype.indexOf&&[0,1].indexOf(1,2)!==-1;lt(st,{indexOf:function(t){var e=So&&wo(this)?this.split(""):Eo(this),n=e.length>>>0;if(!n)return-1;var r=0;for(arguments.length>1&&(r=Ks(arguments[1])),r=r>=0?r:Math.max(0,n+r);r<n;r++)if(r in e&&e[r]===t)return r;return-1}},ec);var yo=ct.split;"ab".split(/(?:ab)*/).length!==2||".".split(/(.?)(.?)/).length!==4||"tesst".split(/(s)*/)[1]==="t"||"test".split(/(?:)/,-1).length!==4||"".split(/.?/).length||".".split(/()()/).length>1?(function(){var i=/()??/.exec("")[1]===void 0;ct.split=function(t,e){var n=this;if(t===void 0&&e===0)return[];if(Ji.call(t)!=="[object RegExp]")return yo.call(this,t,e);var r=[],s=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.extended?"x":"")+(t.sticky?"y":""),d=0,u,p,_,T;for(t=new RegExp(t.source,s+"g"),n+="",i||(u=new RegExp("^"+t.source+"$(?!\\s)",s)),e=e===void 0?-1>>>0:Qs(e);(p=t.exec(n))&&(_=p.index+p[0].length,!(_>d&&(r.push(n.slice(d,p.index)),!i&&p.length>1&&p[0].replace(u,function(){for(var m=1;m<arguments.length-2;m++)arguments[m]===void 0&&(p[m]=void 0)}),p.length>1&&p.index<n.length&&st.push.apply(r,p.slice(1)),T=p[0].length,d=_,r.length>=e)));)t.lastIndex===p.index&&t.lastIndex++;return d===n.length?(T||!t.test(""))&&r.push(""):r.push(n.slice(d)),r.length>e?r.slice(0,e):r}})():"0".split(void 0,0).length&&(ct.split=function(t,e){return t===void 0&&e===0?[]:yo.call(this,t,e)});var tc=ct.substr,ic="".substr&&"0b".substr(-1)!=="b";lt(ct,{substr:function(t,e){return tc.call(this,t<0&&(t=this.length+t)<0?0:t,e)}},ic)});var Mo=g((tu,ko)=>{"use strict";var Bt=/[\x00-\x1f\ud800-\udfff\ufffe\uffff\u0300-\u0333\u033d-\u0346\u034a-\u034c\u0350-\u0352\u0357-\u0358\u035c-\u0362\u0374\u037e\u0387\u0591-\u05af\u05c4\u0610-\u0617\u0653-\u0654\u0657-\u065b\u065d-\u065e\u06df-\u06e2\u06eb-\u06ec\u0730\u0732-\u0733\u0735-\u0736\u073a\u073d\u073f-\u0741\u0743\u0745\u0747\u07eb-\u07f1\u0951\u0958-\u095f\u09dc-\u09dd\u09df\u0a33\u0a36\u0a59-\u0a5b\u0a5e\u0b5c-\u0b5d\u0e38-\u0e39\u0f43\u0f4d\u0f52\u0f57\u0f5c\u0f69\u0f72-\u0f76\u0f78\u0f80-\u0f83\u0f93\u0f9d\u0fa2\u0fa7\u0fac\u0fb9\u1939-\u193a\u1a17\u1b6b\u1cda-\u1cdb\u1dc0-\u1dcf\u1dfc\u1dfe\u1f71\u1f73\u1f75\u1f77\u1f79\u1f7b\u1f7d\u1fbb\u1fbe\u1fc9\u1fcb\u1fd3\u1fdb\u1fe3\u1feb\u1fee-\u1fef\u1ff9\u1ffb\u1ffd\u2000-\u2001\u20d0-\u20d1\u20d4-\u20d7\u20e7-\u20e9\u2126\u212a-\u212b\u2329-\u232a\u2adc\u302b-\u302c\uaab2-\uaab3\uf900-\ufa0d\ufa10\ufa12\ufa15-\ufa1e\ufa20\ufa22\ufa25-\ufa26\ufa2a-\ufa2d\ufa30-\ufa6d\ufa70-\ufad9\ufb1d\ufb1f\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufb4e\ufff0-\uffff]/g,Zi,nc=function(i){var t,e={},n=[];for(t=0;t<65536;t++)n.push(String.fromCharCode(t));return i.lastIndex=0,n.join("").replace(i,function(r){return e[r]="\\u"+("0000"+r.charCodeAt(0).toString(16)).slice(-4),""}),i.lastIndex=0,e};ko.exports={quote:function(i){var t=JSON.stringify(i);return Bt.lastIndex=0,Bt.test(t)?(Zi||(Zi=nc(Bt)),t.replace(Bt,function(e){return Zi[e]})):t}}});var No=g((iu,To)=>{"use strict";var $t=function(){};To.exports=function(i){return{filterToEnabled:function(t,e){var n={main:[],facade:[]};return t?typeof t=="string"&&(t=[t]):t=[],i.forEach(function(r){if(r){if(r.transportName==="websocket"&&e.websocket===!1){$t("disabled from server","websocket");return}if(t.length&&t.indexOf(r.transportName)===-1){$t("not in whitelist",r.transportName);return}r.enabled(e)?($t("enabled",r.transportName),n.main.push(r),r.facadeTransport&&n.facade.push(r.facadeTransport)):$t("disabled",r.transportName)}}),n}}}});var Po=g((nu,Oo)=>{"use strict";var Ki={};["log","debug","warn"].forEach(function(i){var t;try{t=global.console&&global.console[i]&&global.console[i].apply}catch{}Ki[i]=t?function(){return global.console[i].apply(global.console,arguments)}:i==="log"?function(){}:Ki.log});Oo.exports=Ki});var zt=g((ru,Do)=>{"use strict";function Oe(i){this.type=i}Oe.prototype.initEvent=function(i,t,e){return this.type=i,this.bubbles=t,this.cancelable=e,this.timeStamp=+new Date,this};Oe.prototype.stopPropagation=function(){};Oe.prototype.preventDefault=function(){};Oe.CAPTURING_PHASE=1;Oe.AT_TARGET=2;Oe.BUBBLING_PHASE=3;Do.exports=Oe});var Qi=g((ou,Ao)=>{"use strict";Ao.exports=global.location||{origin:"http://localhost:80",protocol:"http:",host:"localhost",port:80,href:"http://localhost/",hash:""}});var Lo=g((au,Ro)=>{"use strict";var rc=C(),qo=zt();function Vo(){qo.call(this),this.initEvent("close",!1,!1),this.wasClean=!1,this.code=0,this.reason=""}rc(Vo,qo);Ro.exports=Vo});var Wo=g((su,Ho)=>{"use strict";var oc=C(),jo=zt();function Fo(i){jo.call(this),this.initEvent("message",!1,!1),this.data=i}oc(Fo,jo);Ho.exports=Fo});var $o=g((cu,Bo)=>{"use strict";var Uo=A().EventEmitter,ac=C();function dt(){var i=this;Uo.call(this),this.to=setTimeout(function(){i.emit("finish",200,"{}")},dt.timeout)}ac(dt,Uo);dt.prototype.close=function(){clearTimeout(this.to)};dt.timeout=2e3;Bo.exports=dt});var en=g((lu,Go)=>{"use strict";var zo=A().EventEmitter,sc=C(),cc=Ht(),lc=function(){};function Yi(i,t){zo.call(this);var e=this,n=+new Date;this.xo=new t("GET",i),this.xo.once("finish",function(r,s){var d,u;if(r===200){if(u=+new Date-n,s)try{d=JSON.parse(s)}catch{lc("bad json",s)}cc.isObject(d)||(d={})}e.emit("finish",d,u),e.removeAllListeners()})}sc(Yi,zo);Yi.prototype.close=function(){this.removeAllListeners(),this.xo.close()};Go.exports=Yi});var tn=g((du,Jo)=>{"use strict";var dc=C(),Xo=A().EventEmitter,uc=Le(),pc=en();function Gt(i){var t=this;Xo.call(this),this.ir=new pc(i,uc),this.ir.once("finish",function(e,n){t.ir=null,t.emit("message",JSON.stringify([e,n]))})}dc(Gt,Xo);Gt.transportName="iframe-info-receiver";Gt.prototype.close=function(){this.ir&&(this.ir.close(),this.ir=null),this.removeAllListeners()};Jo.exports=Gt});var Yo=g((uu,Qo)=>{"use strict";var Zo=A().EventEmitter,mc=C(),hc=de(),Ko=Fi(),fc=tn(),gc=function(){};function Xt(i,t){var e=this;Zo.call(this);var n=function(){var r=e.ifr=new Ko(fc.transportName,t,i);r.once("message",function(s){if(s){var d;try{d=JSON.parse(s)}catch{gc("bad json",s),e.emit("finish"),e.close();return}var u=d[0],p=d[1];e.emit("finish",u,p)}e.close()}),r.once("close",function(){e.emit("finish"),e.close()})};global.document.body?n():hc.attachEvent("load",n)}mc(Xt,Zo);Xt.enabled=function(){return Ko.enabled()};Xt.prototype.close=function(){this.ifr&&this.ifr.close(),this.removeAllListeners(),this.ifr=null};Qo.exports=Xt});var oa=g((pu,ra)=>{"use strict";var na=A().EventEmitter,bc=C(),vc=G(),ea=jt(),ta=Ye(),_c=Le(),xc=$o(),ia=Yo(),Jt=en(),Be=function(){};function be(i,t){Be(i);var e=this;na.call(this),setTimeout(function(){e.doXhr(i,t)},0)}bc(be,na);be._getReceiver=function(i,t,e){return e.sameOrigin?new Jt(t,_c):ta.enabled?new Jt(t,ta):ea.enabled&&e.sameScheme?new Jt(t,ea):ia.enabled()?new ia(i,t):new Jt(t,xc)};be.prototype.doXhr=function(i,t){var e=this,n=vc.addPath(i,"/info");Be("doXhr",n),this.xo=be._getReceiver(i,n,t),this.timeoutRef=setTimeout(function(){Be("timeout"),e._cleanup(!1),e.emit("finish")},be.timeout),this.xo.once("finish",function(r,s){Be("finish",r,s),e._cleanup(!0),e.emit("finish",r,s)})};be.prototype._cleanup=function(i){Be("_cleanup"),clearTimeout(this.timeoutRef),this.timeoutRef=null,!i&&this.xo&&this.xo.close(),this.xo=null};be.prototype.close=function(){Be("close"),this.removeAllListeners(),this._cleanup(!1)};be.timeout=8e3;ra.exports=be});var ca=g((mu,sa)=>{"use strict";var aa=Ue();function ut(i){this._transport=i,i.on("message",this._transportMessage.bind(this)),i.on("close",this._transportClose.bind(this))}ut.prototype._transportClose=function(i,t){aa.postMessage("c",JSON.stringify([i,t]))};ut.prototype._transportMessage=function(i){aa.postMessage("t",i)};ut.prototype._send=function(i){this._transport.send(i)};ut.prototype._close=function(){this._transport.close(),this._transport.removeAllListeners()};sa.exports=ut});var pa=g((hu,ua)=>{"use strict";var la=G(),yc=de(),Cc=ca(),da=tn(),nn=Ue(),Zt=Qi(),rn=function(){};ua.exports=function(i,t){var e={};t.forEach(function(r){r.facadeTransport&&(e[r.facadeTransport.transportName]=r.facadeTransport)}),e[da.transportName]=da;var n;i.bootstrap_iframe=function(){var r;nn.currentWindowId=Zt.hash.slice(1);var s=function(d){if(d.source===parent&&(typeof n>"u"&&(n=d.origin),d.origin===n)){var u;try{u=JSON.parse(d.data)}catch{rn("bad json",d.data);return}if(u.windowId===nn.currentWindowId)switch(u.type){case"s":var p;try{p=JSON.parse(u.data)}catch{rn("bad json",u.data);break}var _=p[0],T=p[1],m=p[2],B=p[3];if(rn(_,T,m,B),_!==i.version)throw new Error('Incompatible SockJS! Main site uses: "'+_+'", the iframe: "'+i.version+'".');if(!la.isOriginEqual(m,Zt.href)||!la.isOriginEqual(B,Zt.href))throw new Error("Can't connect to different domain from within an iframe. ("+Zt.href+", "+m+", "+B+")");r=new Cc(new e[T](m,B));break;case"m":r._send(u.data);break;case"c":r&&r._close(),r=null;break}}};yc.attachEvent("message",s),nn.postMessage("s")}}});var _a=g((fu,va)=>{"use strict";Io();var wc=yi(),Ec=C(),ma=Ee(),Sc=Mo(),pt=G(),Ic=de(),kc=No(),Mc=Ht(),Tc=je(),Nc=Po(),on=zt(),fa=wi(),Kt=Qi(),Oc=Lo(),ha=Wo(),Pc=oa(),N=function(){},ga;function w(i,t,e){if(!(this instanceof w))return new w(i,t,e);if(arguments.length<1)throw new TypeError("Failed to construct 'SockJS: 1 argument required, but only 0 present");fa.call(this),this.readyState=w.CONNECTING,this.extensions="",this.protocol="",e=e||{},e.protocols_whitelist&&Nc.warn("'protocols_whitelist' is DEPRECATED. Use 'transports' instead."),this._transportsWhitelist=e.transports,this._transportOptions=e.transportOptions||{},this._timeout=e.timeout||0;var n=e.sessionId||8;if(typeof n=="function")this._generateSessionId=n;else if(typeof n=="number")this._generateSessionId=function(){return ma.string(n)};else throw new TypeError("If sessionId is used in the options, it needs to be a number or a function.");this._server=e.server||ma.numberString(1e3);var r=new wc(i);if(!r.host||!r.protocol)throw new SyntaxError("The URL '"+i+"' is invalid");if(r.hash)throw new SyntaxError("The URL must not contain a fragment");if(r.protocol!=="http:"&&r.protocol!=="https:")throw new SyntaxError("The URL's scheme must be either 'http:' or 'https:'. '"+r.protocol+"' is not allowed.");var s=r.protocol==="https:";if(Kt.protocol==="https:"&&!s&&!pt.isLoopbackAddr(r.hostname))throw new Error("SecurityError: An insecure SockJS connection may not be initiated from a page loaded over HTTPS");t?Array.isArray(t)||(t=[t]):t=[];var d=t.sort();d.forEach(function(p,_){if(!p)throw new SyntaxError("The protocols entry '"+p+"' is invalid.");if(_<d.length-1&&p===d[_+1])throw new SyntaxError("The protocols entry '"+p+"' is duplicated.")});var u=pt.getOrigin(Kt.href);this._origin=u?u.toLowerCase():null,r.set("pathname",r.pathname.replace(/\/+$/,"")),this.url=r.href,N("using url",this.url),this._urlInfo={nullOrigin:!Tc.hasDomain(),sameOrigin:pt.isOriginEqual(this.url,Kt.href),sameScheme:pt.isSchemeEqual(this.url,Kt.href)},this._ir=new Pc(this.url,this._urlInfo),this._ir.once("finish",this._receiveInfo.bind(this))}Ec(w,fa);function ba(i){return i===1e3||i>=3e3&&i<=4999}w.prototype.close=function(i,t){if(i&&!ba(i))throw new Error("InvalidAccessError: Invalid code");if(t&&t.length>123)throw new SyntaxError("reason argument has an invalid length");if(!(this.readyState===w.CLOSING||this.readyState===w.CLOSED)){var e=!0;this._close(i||1e3,t||"Normal closure",e)}};w.prototype.send=function(i){if(typeof i!="string"&&(i=""+i),this.readyState===w.CONNECTING)throw new Error("InvalidStateError: The connection has not been established yet");this.readyState===w.OPEN&&this._transport.send(Sc.quote(i))};w.version=Li();w.CONNECTING=0;w.OPEN=1;w.CLOSING=2;w.CLOSED=3;w.prototype._receiveInfo=function(i,t){if(N("_receiveInfo",t),this._ir=null,!i){this._close(1002,"Cannot connect to server");return}this._rto=this.countRTO(t),this._transUrl=i.base_url?i.base_url:this.url,i=Mc.extend(i,this._urlInfo),N("info",i);var e=ga.filterToEnabled(this._transportsWhitelist,i);this._transports=e.main,N(this._transports.length+" enabled transports"),this._connect()};w.prototype._connect=function(){for(var i=this._transports.shift();i;i=this._transports.shift()){if(N("attempt",i.transportName),i.needBody&&(!global.document.body||typeof global.document.readyState<"u"&&global.document.readyState!=="complete"&&global.document.readyState!=="interactive")){N("waiting for body"),this._transports.unshift(i),Ic.attachEvent("load",this._connect.bind(this));return}var t=Math.max(this._timeout,this._rto*i.roundTrips||5e3);this._transportTimeoutId=setTimeout(this._transportTimeout.bind(this),t),N("using timeout",t);var e=pt.addPath(this._transUrl,"/"+this._server+"/"+this._generateSessionId()),n=this._transportOptions[i.transportName];N("transport url",e);var r=new i(e,this._transUrl,n);r.on("message",this._transportMessage.bind(this)),r.once("close",this._transportClose.bind(this)),r.transportName=i.transportName,this._transport=r;return}this._close(2e3,"All transports failed",!1)};w.prototype._transportTimeout=function(){N("_transportTimeout"),this.readyState===w.CONNECTING&&(this._transport&&this._transport.close(),this._transportClose(2007,"Transport timed out"))};w.prototype._transportMessage=function(i){N("_transportMessage",i);var t=this,e=i.slice(0,1),n=i.slice(1),r;switch(e){case"o":this._open();return;case"h":this.dispatchEvent(new on("heartbeat")),N("heartbeat",this.transport);return}if(n)try{r=JSON.parse(n)}catch{N("bad json",n)}if(typeof r>"u"){N("empty payload",n);return}switch(e){case"a":Array.isArray(r)&&r.forEach(function(s){N("message",t.transport,s),t.dispatchEvent(new ha(s))});break;case"m":N("message",this.transport,r),this.dispatchEvent(new ha(r));break;case"c":Array.isArray(r)&&r.length===2&&this._close(r[0],r[1],!0);break}};w.prototype._transportClose=function(i,t){if(N("_transportClose",this.transport,i,t),this._transport&&(this._transport.removeAllListeners(),this._transport=null,this.transport=null),!ba(i)&&i!==2e3&&this.readyState===w.CONNECTING){this._connect();return}this._close(i,t)};w.prototype._open=function(){N("_open",this._transport&&this._transport.transportName,this.readyState),this.readyState===w.CONNECTING?(this._transportTimeoutId&&(clearTimeout(this._transportTimeoutId),this._transportTimeoutId=null),this.readyState=w.OPEN,this.transport=this._transport.transportName,this.dispatchEvent(new on("open")),N("connected",this.transport)):this._close(1006,"Server lost session")};w.prototype._close=function(i,t,e){N("_close",this.transport,i,t,e,this.readyState);var n=!1;if(this._ir&&(n=!0,this._ir.close(),this._ir=null),this._transport&&(this._transport.close(),this._transport=null,this.transport=null),this.readyState===w.CLOSED)throw new Error("InvalidStateError: SockJS has already been closed");this.readyState=w.CLOSING,setTimeout((function(){this.readyState=w.CLOSED,n&&this.dispatchEvent(new on("error"));var r=new Oc("close");r.wasClean=e||!1,r.code=i||1e3,r.reason=t,this.dispatchEvent(r),this.onmessage=this.onclose=this.onerror=null,N("disconnected")}).bind(this),0)};w.prototype.countRTO=function(i){return i>100?4*i:300+i};va.exports=function(i){return ga=kc(i),pa()(w,i),w}});var an=g((gu,xa)=>{"use strict";var Dc=_o();xa.exports=_a()(Dc);"_sockjs_onload"in global&&setTimeout(global._sockjs_onload,1)});function An(i,t){i.terminate=function(){let e=()=>{};this.onerror=e,this.onmessage=e,this.onopen=e;let n=new Date,r=Math.random().toString().substring(2,8),s=this.onclose;this.onclose=d=>{let u=new Date().getTime()-n.getTime();t(`Discarded socket (#${r})  closed after ${u}ms, with code/reason: ${d.code}/${d.reason}`)},this.close(),s?.call(i,{code:4001,reason:`Quick discarding socket (#${r}) without waiting for the shutdown sequence.`,wasClean:!1})}}var we={LF:`
`,NULL:"\0"};var Xe=class i{get body(){return!this._body&&this.isBinaryBody&&(this._body=new TextDecoder().decode(this._binaryBody)),this._body||""}get binaryBody(){return!this._binaryBody&&!this.isBinaryBody&&(this._binaryBody=new TextEncoder().encode(this._body)),this._binaryBody}constructor(t){let{command:e,headers:n,body:r,binaryBody:s,escapeHeaderValues:d,skipContentLengthHeader:u}=t;this.command=e,this.headers=Object.assign({},n||{}),s?(this._binaryBody=s,this.isBinaryBody=!0):(this._body=r||"",this.isBinaryBody=!1),this.escapeHeaderValues=d||!1,this.skipContentLengthHeader=u||!1}static fromRawFrame(t,e){let n={},r=s=>s.replace(/^\s+|\s+$/g,"");for(let s of t.headers.reverse()){let d=s.indexOf(":"),u=r(s[0]),p=r(s[1]);e&&t.command!=="CONNECT"&&t.command!=="CONNECTED"&&(p=i.hdrValueUnEscape(p)),n[u]=p}return new i({command:t.command,headers:n,binaryBody:t.binaryBody,escapeHeaderValues:e})}toString(){return this.serializeCmdAndHeaders()}serialize(){let t=this.serializeCmdAndHeaders();return this.isBinaryBody?i.toUnit8Array(t,this._binaryBody).buffer:t+this._body+we.NULL}serializeCmdAndHeaders(){let t=[this.command];this.skipContentLengthHeader&&delete this.headers["content-length"];for(let e of Object.keys(this.headers||{})){let n=this.headers[e];this.escapeHeaderValues&&this.command!=="CONNECT"&&this.command!=="CONNECTED"?t.push(`${e}:${i.hdrValueEscape(`${n}`)}`):t.push(`${e}:${n}`)}return(this.isBinaryBody||!this.isBodyEmpty()&&!this.skipContentLengthHeader)&&t.push(`content-length:${this.bodyLength()}`),t.join(we.LF)+we.LF+we.LF}isBodyEmpty(){return this.bodyLength()===0}bodyLength(){let t=this.binaryBody;return t?t.length:0}static sizeOfUTF8(t){return t?new TextEncoder().encode(t).length:0}static toUnit8Array(t,e){let n=new TextEncoder().encode(t),r=new Uint8Array([0]),s=new Uint8Array(n.length+e.length+r.length);return s.set(n),s.set(e,n.length),s.set(r,n.length+e.length),s}static marshall(t){return new i(t).serialize()}static hdrValueEscape(t){return t.replace(/\\/g,"\\\\").replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/:/g,"\\c")}static hdrValueUnEscape(t){return t.replace(/\\r/g,"\r").replace(/\\n/g,`
`).replace(/\\c/g,":").replace(/\\\\/g,"\\")}};var Mt=class{constructor(t,e){this.onFrame=t,this.onIncomingPing=e,this._encoder=new TextEncoder,this._decoder=new TextDecoder,this._token=[],this._initState()}parseChunk(t,e=!1){let n;if(typeof t=="string"?n=this._encoder.encode(t):n=new Uint8Array(t),e&&n[n.length-1]!==0){let r=new Uint8Array(n.length+1);r.set(n,0),r[n.length]=0,n=r}for(let r=0;r<n.length;r++){let s=n[r];this._onByte(s)}}_collectFrame(t){if(t!==0&&t!==13){if(t===10){this.onIncomingPing();return}this._onByte=this._collectCommand,this._reinjectByte(t)}}_collectCommand(t){if(t!==13){if(t===10){this._results.command=this._consumeTokenAsUTF8(),this._onByte=this._collectHeaders;return}this._consumeByte(t)}}_collectHeaders(t){if(t!==13){if(t===10){this._setupCollectBody();return}this._onByte=this._collectHeaderKey,this._reinjectByte(t)}}_reinjectByte(t){this._onByte(t)}_collectHeaderKey(t){if(t===58){this._headerKey=this._consumeTokenAsUTF8(),this._onByte=this._collectHeaderValue;return}this._consumeByte(t)}_collectHeaderValue(t){if(t!==13){if(t===10){this._results.headers.push([this._headerKey,this._consumeTokenAsUTF8()]),this._headerKey=void 0,this._onByte=this._collectHeaders;return}this._consumeByte(t)}}_setupCollectBody(){let t=this._results.headers.filter(e=>e[0]==="content-length")[0];t?(this._bodyBytesRemaining=parseInt(t[1],10),this._onByte=this._collectBodyFixedSize):this._onByte=this._collectBodyNullTerminated}_collectBodyNullTerminated(t){if(t===0){this._retrievedBody();return}this._consumeByte(t)}_collectBodyFixedSize(t){if(this._bodyBytesRemaining--===0){this._retrievedBody();return}this._consumeByte(t)}_retrievedBody(){this._results.binaryBody=this._consumeTokenAsRaw();try{this.onFrame(this._results)}catch(t){console.log("Ignoring an exception thrown by a frame handler. Original exception: ",t)}this._initState()}_consumeByte(t){this._token.push(t)}_consumeTokenAsUTF8(){return this._decoder.decode(this._consumeTokenAsRaw())}_consumeTokenAsRaw(){let t=new Uint8Array(this._token);return this._token=[],t}_initState(){this._results={command:void 0,headers:[],binaryBody:void 0},this._token=[],this._headerKey=void 0,this._onByte=this._collectFrame}};var le=(function(i){return i[i.CONNECTING=0]="CONNECTING",i[i.OPEN=1]="OPEN",i[i.CLOSING=2]="CLOSING",i[i.CLOSED=3]="CLOSED",i})(le||{}),Y=(function(i){return i[i.ACTIVE=0]="ACTIVE",i[i.DEACTIVATING=1]="DEACTIVATING",i[i.INACTIVE=2]="INACTIVE",i})(Y||{}),Tt=(function(i){return i[i.LINEAR=0]="LINEAR",i[i.EXPONENTIAL=1]="EXPONENTIAL",i})(Tt||{}),qe=(function(i){return i.Interval="interval",i.Worker="worker",i})(qe||{});var Nt=class{constructor(t,e=qe.Interval,n){this._interval=t,this._strategy=e,this._debug=n,this._workerScript=`
    var startTime = Date.now();
    setInterval(function() {
        self.postMessage(Date.now() - startTime);
    }, ${this._interval});
  `}start(t){this.stop(),this.shouldUseWorker()?this.runWorker(t):this.runInterval(t)}stop(){this.disposeWorker(),this.disposeInterval()}shouldUseWorker(){return typeof Worker<"u"&&this._strategy===qe.Worker}runWorker(t){this._debug("Using runWorker for outgoing pings"),this._worker||(this._worker=new Worker(URL.createObjectURL(new Blob([this._workerScript],{type:"text/javascript"}))),this._worker.onmessage=e=>t(e.data))}runInterval(t){if(this._debug("Using runInterval for outgoing pings"),!this._timer){let e=Date.now();this._timer=setInterval(()=>{t(Date.now()-e)},this._interval)}}disposeWorker(){this._worker&&(this._worker.terminate(),delete this._worker,this._debug("Outgoing ping disposeWorker"))}disposeInterval(){this._timer&&(clearInterval(this._timer),delete this._timer,this._debug("Outgoing ping disposeInterval"))}};var P=class{constructor(t){this.versions=t}supportedVersions(){return this.versions.join(",")}protocolVersions(){return this.versions.map(t=>`v${t.replace(".","")}.stomp`)}};P.V1_0="1.0";P.V1_1="1.1";P.V1_2="1.2";P.default=new P([P.V1_2,P.V1_1,P.V1_0]);var Ot=class{get connectedVersion(){return this._connectedVersion}get connected(){return this._connected}constructor(t,e,n){this._client=t,this._webSocket=e,this._connected=!1,this._serverFrameHandlers={CONNECTED:r=>{this.debug(`connected to server ${r.headers.server}`),this._connected=!0,this._connectedVersion=r.headers.version,this._connectedVersion===P.V1_2&&(this._escapeHeaderValues=!0),this._setupHeartbeat(r.headers),this.onConnect(r)},MESSAGE:r=>{let s=r.headers.subscription,d=this._subscriptions[s]||this.onUnhandledMessage,u=r,p=this,_=this._connectedVersion===P.V1_2?u.headers.ack:u.headers["message-id"];u.ack=(T={})=>p.ack(_,s,T),u.nack=(T={})=>p.nack(_,s,T),d(u)},RECEIPT:r=>{let s=this._receiptWatchers[r.headers["receipt-id"]];s?(s(r),delete this._receiptWatchers[r.headers["receipt-id"]]):this.onUnhandledReceipt(r)},ERROR:r=>{this.onStompError(r)}},this._counter=0,this._subscriptions={},this._receiptWatchers={},this._partialData="",this._escapeHeaderValues=!1,this._lastServerActivityTS=Date.now(),this.debug=n.debug,this.stompVersions=n.stompVersions,this.connectHeaders=n.connectHeaders,this.disconnectHeaders=n.disconnectHeaders,this.heartbeatIncoming=n.heartbeatIncoming,this.heartbeatToleranceMultiplier=n.heartbeatGracePeriods,this.heartbeatOutgoing=n.heartbeatOutgoing,this.splitLargeFrames=n.splitLargeFrames,this.maxWebSocketChunkSize=n.maxWebSocketChunkSize,this.forceBinaryWSFrames=n.forceBinaryWSFrames,this.logRawCommunication=n.logRawCommunication,this.appendMissingNULLonIncoming=n.appendMissingNULLonIncoming,this.discardWebsocketOnCommFailure=n.discardWebsocketOnCommFailure,this.onConnect=n.onConnect,this.onDisconnect=n.onDisconnect,this.onStompError=n.onStompError,this.onWebSocketClose=n.onWebSocketClose,this.onWebSocketError=n.onWebSocketError,this.onUnhandledMessage=n.onUnhandledMessage,this.onUnhandledReceipt=n.onUnhandledReceipt,this.onUnhandledFrame=n.onUnhandledFrame,this.onHeartbeatReceived=n.onHeartbeatReceived,this.onHeartbeatLost=n.onHeartbeatLost}start(){let t=new Mt(e=>{let n=Xe.fromRawFrame(e,this._escapeHeaderValues);this.logRawCommunication||this.debug(`<<< ${n}`),(this._serverFrameHandlers[n.command]||this.onUnhandledFrame)(n)},()=>{this.debug("<<< PONG"),this.onHeartbeatReceived()});this._webSocket.onmessage=e=>{if(this.debug("Received data"),this._lastServerActivityTS=Date.now(),this.logRawCommunication){let n=e.data instanceof ArrayBuffer?new TextDecoder().decode(e.data):e.data;this.debug(`<<< ${n}`)}t.parseChunk(e.data,this.appendMissingNULLonIncoming)},this._webSocket.onclose=e=>{this.debug(`Connection closed to ${this._webSocket.url}`),this._cleanUp(),this.onWebSocketClose(e)},this._webSocket.onerror=e=>{this.onWebSocketError(e)},this._webSocket.onopen=()=>{let e=Object.assign({},this.connectHeaders);this.debug("Web Socket Opened..."),e["accept-version"]=this.stompVersions.supportedVersions(),e["heart-beat"]=[this.heartbeatOutgoing,this.heartbeatIncoming].join(","),this._transmit({command:"CONNECT",headers:e})}}_setupHeartbeat(t){if(t.version!==P.V1_1&&t.version!==P.V1_2||!t["heart-beat"])return;let[e,n]=t["heart-beat"].split(",").map(r=>parseInt(r,10));if(this.heartbeatOutgoing!==0&&n!==0){let r=Math.max(this.heartbeatOutgoing,n);this.debug(`send PING every ${r}ms`),this._pinger=new Nt(r,this._client.heartbeatStrategy,this.debug),this._pinger.start(()=>{this._webSocket.readyState===le.OPEN&&(this._webSocket.send(we.LF),this.debug(">>> PING"))})}if(this.heartbeatIncoming!==0&&e!==0){let r=Math.max(this.heartbeatIncoming,e);this.debug(`check PONG every ${r}ms`),this._ponger=setInterval(()=>{let s=Date.now()-this._lastServerActivityTS;s>r*this.heartbeatToleranceMultiplier&&(this.debug(`did not receive server activity for the last ${s}ms`),this.onHeartbeatLost(),this._closeOrDiscardWebsocket())},r)}}_closeOrDiscardWebsocket(){this.discardWebsocketOnCommFailure?(this.debug("Discarding websocket, the underlying socket may linger for a while"),this.discardWebsocket()):(this.debug("Issuing close on the websocket"),this._closeWebsocket())}forceDisconnect(){this._webSocket&&(this._webSocket.readyState===le.CONNECTING||this._webSocket.readyState===le.OPEN)&&this._closeOrDiscardWebsocket()}_closeWebsocket(){this._webSocket.onmessage=()=>{},this._webSocket.close()}discardWebsocket(){typeof this._webSocket.terminate!="function"&&An(this._webSocket,t=>this.debug(t)),this._webSocket.terminate()}_transmit(t){let{command:e,headers:n,body:r,binaryBody:s,skipContentLengthHeader:d}=t,u=new Xe({command:e,headers:n,body:r,binaryBody:s,escapeHeaderValues:this._escapeHeaderValues,skipContentLengthHeader:d}),p=u.serialize();if(this.logRawCommunication?this.debug(`>>> ${p}`):this.debug(`>>> ${u}`),this.forceBinaryWSFrames&&typeof p=="string"&&(p=new TextEncoder().encode(p)),typeof p!="string"||!this.splitLargeFrames)this._webSocket.send(p);else{let _=p;for(;_.length>0;){let T=_.substring(0,this.maxWebSocketChunkSize);_=_.substring(this.maxWebSocketChunkSize),this._webSocket.send(T),this.debug(`chunk sent = ${T.length}, remaining = ${_.length}`)}}}dispose(){if(this.connected)try{let t=Object.assign({},this.disconnectHeaders);t.receipt||(t.receipt=`close-${this._counter++}`),this.watchForReceipt(t.receipt,e=>{this._closeWebsocket(),this._cleanUp(),this.onDisconnect(e)}),this._transmit({command:"DISCONNECT",headers:t})}catch(t){this.debug(`Ignoring error during disconnect ${t}`)}else(this._webSocket.readyState===le.CONNECTING||this._webSocket.readyState===le.OPEN)&&this._closeWebsocket()}_cleanUp(){this._connected=!1,this._pinger&&(this._pinger.stop(),this._pinger=void 0),this._ponger&&(clearInterval(this._ponger),this._ponger=void 0)}publish(t){let{destination:e,headers:n,body:r,binaryBody:s,skipContentLengthHeader:d}=t,u=Object.assign({destination:e},n);this._transmit({command:"SEND",headers:u,body:r,binaryBody:s,skipContentLengthHeader:d})}watchForReceipt(t,e){this._receiptWatchers[t]=e}subscribe(t,e,n={}){n=Object.assign({},n),n.id||(n.id=`sub-${this._counter++}`),n.destination=t,this._subscriptions[n.id]=e,this._transmit({command:"SUBSCRIBE",headers:n});let r=this;return{id:n.id,unsubscribe(s){return r.unsubscribe(n.id,s)}}}unsubscribe(t,e={}){e=Object.assign({},e),delete this._subscriptions[t],e.id=t,this._transmit({command:"UNSUBSCRIBE",headers:e})}begin(t){let e=t||`tx-${this._counter++}`;this._transmit({command:"BEGIN",headers:{transaction:e}});let n=this;return{id:e,commit(){n.commit(e)},abort(){n.abort(e)}}}commit(t){this._transmit({command:"COMMIT",headers:{transaction:t}})}abort(t){this._transmit({command:"ABORT",headers:{transaction:t}})}ack(t,e,n={}){n=Object.assign({},n),this._connectedVersion===P.V1_2?n.id=t:n["message-id"]=t,n.subscription=e,this._transmit({command:"ACK",headers:n})}nack(t,e,n={}){return n=Object.assign({},n),this._connectedVersion===P.V1_2?n.id=t:n["message-id"]=t,n.subscription=e,this._transmit({command:"NACK",headers:n})}};var Ve=class{get webSocket(){return this._stompHandler?._webSocket}get disconnectHeaders(){return this._disconnectHeaders}set disconnectHeaders(t){this._disconnectHeaders=t,this._stompHandler&&(this._stompHandler.disconnectHeaders=this._disconnectHeaders)}get connected(){return!!this._stompHandler&&this._stompHandler.connected}get connectedVersion(){return this._stompHandler?this._stompHandler.connectedVersion:void 0}get active(){return this.state===Y.ACTIVE}_changeState(t){this.state=t,this.onChangeState(t)}constructor(t={}){this.stompVersions=P.default,this.connectionTimeout=0,this.reconnectDelay=5e3,this._nextReconnectDelay=0,this.maxReconnectDelay=900*1e3,this.reconnectTimeMode=Tt.LINEAR,this.heartbeatIncoming=1e4,this.heartbeatToleranceMultiplier=2,this.heartbeatOutgoing=1e4,this.heartbeatStrategy=qe.Interval,this.splitLargeFrames=!1,this.maxWebSocketChunkSize=8*1024,this.forceBinaryWSFrames=!1,this.appendMissingNULLonIncoming=!1,this.discardWebsocketOnCommFailure=!1,this.state=Y.INACTIVE;let e=()=>{};this.debug=e,this.beforeConnect=e,this.onConnect=e,this.onDisconnect=e,this.onUnhandledMessage=e,this.onUnhandledReceipt=e,this.onUnhandledFrame=e,this.onHeartbeatReceived=e,this.onHeartbeatLost=e,this.onStompError=e,this.onWebSocketClose=e,this.onWebSocketError=e,this.logRawCommunication=!1,this.onChangeState=e,this.connectHeaders={},this._disconnectHeaders={},this.configure(t)}configure(t){Object.assign(this,t),this.maxReconnectDelay>0&&this.maxReconnectDelay<this.reconnectDelay&&(this.debug(`Warning: maxReconnectDelay (${this.maxReconnectDelay}ms) is less than reconnectDelay (${this.reconnectDelay}ms). Using reconnectDelay as the maxReconnectDelay delay.`),this.maxReconnectDelay=this.reconnectDelay)}activate(){let t=()=>{if(this.active){this.debug("Already ACTIVE, ignoring request to activate");return}this._changeState(Y.ACTIVE),this._nextReconnectDelay=this.reconnectDelay,this._connect()};this.state===Y.DEACTIVATING?(this.debug("Waiting for deactivation to finish before activating"),this.deactivate().then(()=>{t()})):t()}async _connect(){if(await this.beforeConnect(this),this._stompHandler){this.debug("There is already a stompHandler, skipping the call to connect");return}if(!this.active){this.debug("Client has been marked inactive, will not attempt to connect");return}this.connectionTimeout>0&&(this._connectionWatcher&&clearTimeout(this._connectionWatcher),this._connectionWatcher=setTimeout(()=>{this.connected||(this.debug(`Connection not established in ${this.connectionTimeout}ms, closing socket`),this.forceDisconnect())},this.connectionTimeout)),this.debug("Opening Web Socket...");let t=this._createWebSocket();this._stompHandler=new Ot(this,t,{debug:this.debug,stompVersions:this.stompVersions,connectHeaders:this.connectHeaders,disconnectHeaders:this._disconnectHeaders,heartbeatIncoming:this.heartbeatIncoming,heartbeatGracePeriods:this.heartbeatToleranceMultiplier,heartbeatOutgoing:this.heartbeatOutgoing,heartbeatStrategy:this.heartbeatStrategy,splitLargeFrames:this.splitLargeFrames,maxWebSocketChunkSize:this.maxWebSocketChunkSize,forceBinaryWSFrames:this.forceBinaryWSFrames,logRawCommunication:this.logRawCommunication,appendMissingNULLonIncoming:this.appendMissingNULLonIncoming,discardWebsocketOnCommFailure:this.discardWebsocketOnCommFailure,onConnect:e=>{if(this._connectionWatcher&&(clearTimeout(this._connectionWatcher),this._connectionWatcher=void 0),this._nextReconnectDelay=this.reconnectDelay,!this.active){this.debug("STOMP got connected while deactivate was issued, will disconnect now"),this._disposeStompHandler();return}this.onConnect(e)},onDisconnect:e=>{this.onDisconnect(e)},onStompError:e=>{this.onStompError(e)},onWebSocketClose:e=>{this._stompHandler=void 0,this.state===Y.DEACTIVATING&&this._changeState(Y.INACTIVE),this.onWebSocketClose(e),this.active&&this._schedule_reconnect()},onWebSocketError:e=>{this.onWebSocketError(e)},onUnhandledMessage:e=>{this.onUnhandledMessage(e)},onUnhandledReceipt:e=>{this.onUnhandledReceipt(e)},onUnhandledFrame:e=>{this.onUnhandledFrame(e)},onHeartbeatReceived:()=>{this.onHeartbeatReceived()},onHeartbeatLost:()=>{this.onHeartbeatLost()}}),this._stompHandler.start()}_createWebSocket(){let t;if(this.webSocketFactory)t=this.webSocketFactory();else if(this.brokerURL)t=new WebSocket(this.brokerURL,this.stompVersions.protocolVersions());else throw new Error("Either brokerURL or webSocketFactory must be provided");return t.binaryType="arraybuffer",t}_schedule_reconnect(){this._nextReconnectDelay>0&&(this.debug(`STOMP: scheduling reconnection in ${this._nextReconnectDelay}ms`),this._reconnector=setTimeout(()=>{this.reconnectTimeMode===Tt.EXPONENTIAL&&(this._nextReconnectDelay=this._nextReconnectDelay*2,this.maxReconnectDelay!==0&&(this._nextReconnectDelay=Math.min(this._nextReconnectDelay,this.maxReconnectDelay))),this._connect()},this._nextReconnectDelay))}async deactivate(t={}){let e=t.force||!1,n=this.active,r;if(this.state===Y.INACTIVE)return this.debug("Already INACTIVE, nothing more to do"),Promise.resolve();if(this._changeState(Y.DEACTIVATING),this._nextReconnectDelay=0,this._reconnector&&(clearTimeout(this._reconnector),this._reconnector=void 0),this._stompHandler&&this.webSocket.readyState!==le.CLOSED){let s=this._stompHandler.onWebSocketClose;r=new Promise((d,u)=>{this._stompHandler.onWebSocketClose=p=>{s(p),d()}})}else return this._changeState(Y.INACTIVE),Promise.resolve();return e?this._stompHandler?.discardWebsocket():n&&this._disposeStompHandler(),r}forceDisconnect(){this._stompHandler&&this._stompHandler.forceDisconnect()}_disposeStompHandler(){this._stompHandler&&this._stompHandler.dispose()}publish(t){this._checkConnection(),this._stompHandler.publish(t)}_checkConnection(){if(!this.connected)throw new TypeError("There is no underlying STOMP connection")}watchForReceipt(t,e){this._checkConnection(),this._stompHandler.watchForReceipt(t,e)}subscribe(t,e,n={}){return this._checkConnection(),this._stompHandler.subscribe(t,e,n)}unsubscribe(t,e={}){this._checkConnection(),this._stompHandler.unsubscribe(t,e)}begin(t){return this._checkConnection(),this._stompHandler.begin(t)}commit(t){this._checkConnection(),this._stompHandler.commit(t)}abort(t){this._checkConnection(),this._stompHandler.abort(t)}ack(t,e,n={}){this._checkConnection(),this._stompHandler.ack(t,e,n)}nack(t,e,n={}){this._checkConnection(),this._stompHandler.nack(t,e,n)}};var ya=ln(an());var Qt=class i{client;connected=M(!1);messages=M([]);onlineUsers=M([]);connect(){let t=localStorage.getItem("accessToken");t&&(this.client=new Ve({webSocketFactory:()=>new ya.default(`${q.apiUrl}/ws`),reconnectDelay:5e3,connectHeaders:{Authorization:`Bearer ${t}`}}),this.client.onConnect=()=>{this.connected.set(!0),this.client.onStompError=e=>{console.error("\u274C Error STOMP",e)},this.client.onWebSocketError=e=>{console.error("\u274C Error WS",e)},this.client.subscribe("/topic/usuarios",e=>{this.onlineUsers.set(JSON.parse(e.body))}),this.client.subscribe("/user/queue/messages",e=>{let n=JSON.parse(e.body);this.messages.update(r=>[...r,n])})},this.client.onDisconnect=()=>{this.connected.set(!1)},this.client.activate())}disconnect(){this.client?.deactivate()}sendPrivateMessage(t,e){if(!this.client?.connected){console.warn("\u274C No conectado");return}this.client.publish({destination:"/app/chat/private",body:JSON.stringify({to:t,content:e})})}static \u0275fac=function(e){return new(e||i)};static \u0275prov=Z({token:i,factory:i.\u0275fac,providedIn:"root"})};var qc=(i,t)=>({"bg-blue-600 text-white ml-auto rounded-tr-none":i,"bg-white text-gray-800 mr-auto rounded-tl-none border border-gray-200":t}),Vc=(i,t)=>t.id;function Rc(i,t){i&1&&c(0," \u{1F4AC} ")}function Lc(i,t){i&1&&c(0," \u2715 ")}function jc(i,t){if(i&1){let e=k();o(0,"button",7),x("click",function(){let r=b(e).$implicit,s=h(3);return v(s.abrirChat(r))}),o(1,"div",8),c(2),a(),o(3,"div",9)(4,"div",10),c(5),a()()()}if(i&2){let e=t.$implicit;l(2),E(" ",e.tipo==="AI"?"\u{1F916}":"\u{1F464}"," "),l(3),E(" ",e.nombre," ")}}function Fc(i,t){i&1&&(o(0,"div",6),c(1," Cargando m\xE1s contactos... "),a())}function Hc(i,t){if(i&1){let e=k();o(0,"div",2)(1,"h2",3),c(2,"Mensajes"),a()(),o(3,"div",4),x("scroll",function(r){b(e);let s=h(2);return v(s.onScroll(r))}),De(4,jc,6,2,"button",5,Vc),$(6,Fc,2,0,"div",6),a()}if(i&2){let e=h(2);l(4),Ae(e.contactos()),l(2),z(e.loading?6:-1)}}function Wc(i,t){if(i&1&&(o(0,"div",19),c(1),a()),i&2){let e=t.$implicit;f("ngClass",fn(2,qc,e.from==="user",e.from==="ai")),l(),E(" ",e.text," ")}}function Uc(i,t){i&1&&(o(0,"div",20),I(1,"div",26)(2,"div",27)(3,"div",28),a())}function Bc(i,t){if(i&1){let e=k();o(0,"div",11)(1,"div",12)(2,"button",13),x("click",function(){b(e);let r=h(2);return v(r.volver())}),o(3,"span",14),c(4,"\u2B05"),a()(),o(5,"div",15)(6,"span",16),c(7),a(),o(8,"span",17),c(9,"En l\xEDnea"),a()()()(),o(10,"div",18),De(11,Wc,2,5,"div",19,ft),$(13,Uc,4,0,"div",20),a(),o(14,"div",21)(15,"div",22)(16,"textarea",23),F("ngModelChange",function(r){b(e);let s=h(2);return j(s.input,r)||(s.input=r),v(r)}),x("keydown.enter",function(r){b(e);let s=h(2);return r.preventDefault(),v(s.send())}),c(17,"          "),a()(),o(18,"button",24),x("click",function(){b(e);let r=h(2);return v(r.send())}),o(19,"span",25),c(20,"\u27A4"),a()()()}if(i&2){let e,n=h(2);l(7),y((e=n.chatActivo())==null?null:e.nombre),l(4),Ae(n.messages()),l(2),z(n.sending()?13:-1),l(3),L("ngModel",n.input),f("disabled",n.sending()),l(2),f("disabled",!n.input.trim()||n.sending())}}function $c(i,t){if(i&1&&(o(0,"div",1),$(1,Hc,7,1),$(2,Bc,21,5),a()),i&2){let e=h();l(),z(e.viewMode()==="LIST"?1:-1),l(),z(e.viewMode()==="CHAT"&&e.chatActivo()?2:-1)}}var Yt=class i{http=V(W);chatWs=V(Qt);open=M(!1);viewMode=M("LIST");chatActivo=M(null);input="";sending=M(!1);conversationId=crypto.randomUUID();aiMessages=M([]);contactos=M([{id:"AI",nombre:"Agente AI",tipo:"AI"}]);page=0;lastPage=!1;loading=!1;messages=bn(()=>{let t=this.chatActivo();if(!t)return[];let e={from:"ai",text:t.tipo==="AI"?"Hola \u{1F44B} \xBFEn qu\xE9 te ayudo?":`\u{1F4AC} Chat con ${t.nombre}`};if(t.tipo==="AI")return[e,...this.aiMessages()];let n=this.chatWs.messages().filter(r=>r.from===t.username||r.to===t.username).map(r=>({from:r.from===t.username?"ai":"user",text:r.content}));return[e,...n]});ngOnInit(){this.cargarUsuarios()}toggle(){this.open.update(t=>!t),this.viewMode.set("LIST"),this.open()?this.chatWs.connect():this.chatWs.disconnect()}abrirChat(t){this.chatActivo.set(t),this.viewMode.set("CHAT"),t.tipo==="AI"&&(this.conversationId=crypto.randomUUID(),this.aiMessages.set([]))}cargarUsuarios(){if(this.loading||this.lastPage)return;this.loading=!0;let t=localStorage.getItem("accessToken"),e=t?Dn.getUsernameFromToken(t)?.toLowerCase():null;this.http.get(`${q.apiUrl}/public/api/auth?page=${this.page}&size=10`).subscribe({next:n=>{let r=n.content.filter(s=>s.username.toLowerCase()!==e).map(s=>({id:s.id,username:s.username,nombre:`${s.nombre} ${s.apellido}`,tipo:"USER"}));this.contactos.update(s=>{let d=new Set(s.map(p=>p.id)),u=r.filter(p=>!d.has(p.id));return[...s,...u]}),this.lastPage=n.last,this.lastPage||this.page++},error:n=>{console.error("Error cargando usuarios",n)},complete:()=>{this.loading=!1}})}send(){let t=this.input.trim(),e=this.chatActivo();!t||!e||this.sending()||(this.input="",e.tipo==="AI"?this.enviarAIA(t):this.chatWs.sendPrivateMessage(e.username,t))}enviarAIA(t){this.aiMessages.update(e=>[...e,{from:"user",text:t}]),this.sending.set(!0),this.http.post(`${q.apiUrl}/api/chat?conversationId=${this.conversationId}`,t,{responseType:"text"}).subscribe({next:e=>{let n=e.replace(/(\d+\.)/g,`
$1`).replace(/\.\s+/g,`.

`);this.aiMessages.update(r=>[...r,{from:"ai",text:n.trim()}])},error:()=>this.aiMessages.update(e=>[...e,{from:"ai",text:"\u26A0\uFE0F Error de conexi\xF3n."}]),complete:()=>this.sending.set(!1)})}onScroll(t){let e=t.target,n=e.scrollTop+e.clientHeight,r=e.scrollHeight-50;n>=r&&this.cargarUsuarios()}volver=()=>{this.viewMode.set("LIST"),this.chatActivo.set(null)};static \u0275fac=function(e){return new(e||i)};static \u0275cmp=D({type:i,selectors:[["app-chat-widget"]],decls:4,vars:2,consts:[[1,"fixed","bottom-6","right-6","z-50","h-14","w-14","rounded-full","bg-blue-600","text-white","shadow-xl","hover:bg-blue-700","transition-transform","active:scale-95","flex","items-center","justify-center","text-2xl",3,"click"],[1,"fixed","bottom-24","right-6","z-50","w-[90vw]","md:w-[430px]","h-[70vh]","md:h-[570px]","bg-white","rounded-2xl","shadow-2xl","border","flex","flex-col","overflow-hidden","animate-in","fade-in","slide-in-from-bottom-4","duration-300"],[1,"px-6","py-4","bg-blue-600","text-white","shadow-md"],[1,"text-lg","font-bold"],[1,"flex-1","overflow-y-auto","min-h-0","max-h-full","custom-scroll",3,"scroll"],[1,"w-full","px-5","py-4","text-left","hover:bg-gray-50","flex","items-center","gap-4","border-b","border-gray-100","transition-colors"],[1,"py-4","text-center","text-xs","text-gray-400","animate-pulse"],[1,"w-full","px-5","py-4","text-left","hover:bg-gray-50","flex","items-center","gap-4","border-b","border-gray-100","transition-colors",3,"click"],[1,"h-12","w-12","rounded-full","bg-blue-100","flex","items-center","justify-center","text-2xl","shadow-sm"],[1,"flex-1","text-left"],[1,"text-sm","font-semibold","text-gray-800"],[1,"px-4","py-3","bg-blue-600","text-white","flex","items-center","justify-between","shadow-md"],[1,"flex","items-center","gap-3"],[1,"p-1","hover:bg-blue-500","rounded-full","transition-colors",3,"click"],[1,"text-xl"],[1,"flex","flex-col"],[1,"font-bold","leading-none"],[1,"text-[10px]","opacity-80","uppercase","mt-1"],[1,"flex-1","p-4","overflow-y-auto","space-y-4","bg-[#f0f2f5]"],[1,"max-w-[85%]","px-4","py-2.5","rounded-2xl","text-[13.5px]","shadow-sm","break-words","whitespace-pre-line",3,"ngClass"],[1,"flex","items-center","gap-1","bg-white","border","border-gray-200","w-16","px-3","py-4","rounded-2xl","rounded-tl-none","shadow-sm","ml-1"],[1,"p-4","bg-white","border-t","flex","items-end","gap-2"],[1,"flex-1","bg-gray-100","rounded-2xl","px-3","py-2","flex","items-center"],["placeholder","Escribe un mensaje...","rows","1",1,"w-full","bg-transparent","border-none","focus:ring-0","focus:outline-none","text-sm","resize-none","max-h-32","disabled:opacity-50",3,"ngModelChange","keydown.enter","ngModel","disabled"],[1,"h-10","w-10","flex","items-center","justify-center","bg-blue-600","text-white","rounded-full","hover:bg-blue-700","transition-all","disabled:bg-gray-300","disabled:scale-90","active:scale-90",3,"click","disabled"],[1,"text-lg"],[1,"h-1.5","w-1.5","bg-gray-400","rounded-full","animate-bounce","[animation-duration:0.6s]"],[1,"h-1.5","w-1.5","bg-gray-400","rounded-full","animate-bounce","[animation-duration:0.6s]","[animation-delay:0.2s]"],[1,"h-1.5","w-1.5","bg-gray-400","rounded-full","animate-bounce","[animation-duration:0.6s]","[animation-delay:0.4s]"]],template:function(e,n){e&1&&(o(0,"button",0),x("click",function(){return n.toggle()}),$(1,Rc,1,0)(2,Lc,1,0),a(),$(3,$c,3,2,"div",1)),e&2&&(l(),z(n.open()?2:1),l(2),z(n.open()?3:-1))},dependencies:[H,xt,It,wt,Et,St],styles:['@charset "UTF-8";.typing-dot[_ngcontent-%COMP%]{height:.5rem;width:.5rem}@keyframes _ngcontent-%COMP%_bounce{0%,to{transform:translateY(-25%);animation-timing-function:cubic-bezier(.8,0,1,1)}50%{transform:none;animation-timing-function:cubic-bezier(0,0,.2,1)}}.typing-dot[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_bounce 1s infinite;border-radius:9999px;--tw-bg-opacity: 1;background-color:rgb(107 114 128 / var(--tw-bg-opacity, 1))}.custom-scroll[_ngcontent-%COMP%]{display:block;overflow-y:auto!important;scrollbar-width:thin;scrollbar-color:#ccc #f1f1f1}.custom-scroll[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px;display:block}.custom-scroll[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f1f1f1}.custom-scroll[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#ccc;border-radius:10px}.custom-scroll[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#999}']})};var zc=(i,t)=>t.path;function Gc(i,t){i&1&&I(0,"div",29)}function Xc(i,t){if(i&1){let e=k();$(0,Gc,1,0,"div",29),o(1,"button",30),x("click",function(){let r=b(e).$implicit,s=h(2);return v(s.handleMenuItem(r))}),o(2,"span",31),R(),o(3,"svg",32),I(4,"path"),a()(),c(5),a()}if(i&2){let e=t.$implicit;z(e.dividerAbove?0:-1),l(),pi("text-red-600",e.danger)("hover:bg-red-50",e.danger),f("routerLink",e.route),l(3),ui("d",e.icon),l(),E(" ",e.label," ")}}function Jc(i,t){if(i&1&&(o(0,"div",17)(1,"div",26)(2,"span",27),c(3),a(),o(4,"div")(5,"div",28),c(6),a(),o(7,"div",14),c(8),a()()(),I(9,"div",29),De(10,Xc,6,8,null,null,ft),a()),i&2){let e=h();l(3),E(" ",e.userInitial()," "),l(3),y(e.userName()),l(2),y(e.userRole().toLowerCase()),l(2),Ae(e.userMenuItems)}}function Zc(i,t){if(i&1){let e=k();o(0,"a",33),x("click",function(){b(e);let r=h();return v(r.closeSidebar())}),o(1,"span",34),R(),o(2,"svg",35),I(3,"path"),a()(),c(4),a()}if(i&2){let e=t.$implicit;f("routerLink",e.path),l(3),ui("d",e.icon),l(),E(" ",e.label," ")}}function Kc(i,t){if(i&1){let e=k();o(0,"div",36),x("click",function(){b(e);let r=h();return v(r.closeSidebar())}),a()}}var ei=class i{constructor(t,e){this.router=t;this.authService=e;this.userInitial.set(this.userName().charAt(0).toUpperCase());let n=this.userRole();if(n===n.toUpperCase()){let r=n.charAt(0).toUpperCase()+n.slice(1).toLowerCase();this.userRole.set(r)}}sidebarOpen=M(!1);userMenuOpen=M(!1);userName=M(localStorage.getItem("nombre")||"Usuario");userRole=M(localStorage.getItem("role")||"Personal");userInitial=M("");navItems=M([{label:"Dashboard",path:"/dashboard",icon:"M3 12l2-2 4 4L21 4l2 2L9 20 3 14z"},{label:"Citas",path:"/citas",icon:"M6 2a1 1 0 0 0-1 1v1H4a2 2 0 0 0-2 2v2h20V6a2 2 0 0 0-2-2h-1V3a1 1 0 0 0-1-1H6Zm14 7H2v11a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9Zm-7 3v2h2a1 1 0 1 1 0 2h-2v2a1 1 0 1 1-2 0v-2h-2a1 1 0 1 1 0-2h2v-2a1 1 0 1 1 2 0Z"},{label:"Pacientes",path:"/pacientes",icon:"M12 12a5 5 0 1 0-5-5 5 5 0 0 0 5 5Zm0 2c-4.42 0-8 2.24-8 5v1h16v-1c0-2.76-3.58-5-8-5Z"},{label:"Especialidades",path:"/especialidades",icon:"M4 22h16V8h-3V4H7v4H4v14Zm5-10h6v6h-6v-6Zm-2 10v-8h10v8H7Zm2-12h6V6H9v4Z"},{label:"Medicos",path:"/medicos",icon:"M12 12a5 5 0 1 0-5-5 5 5 0 0 0 5 5Zm-7 9v-1c0-2.76 3.58-5 8-5s8 2.24 8 5v1H5Zm13-11h-2V8a1 1 0 1 0-2 0v2h-2a1 1 0 1 0 0 2h2v2a1 1 0 1 0 2 0v-2h2a1 1 0 1 0 0-2Z"}]);userMenuItems=[{label:"Ver Perfil",icon:"M12 12a5 5 0 1 0-5-5 5 5 0 0 0 5 5Zm0 2c-5.33 0-8 2.67-8 6v2h16v-2c0-3.33-2.67-6-8-6Z",route:"/profile"},{label:"Configuraci\xF3n",icon:"M12 8a4 4 0 1 0 4 4 4 4 0 0 0-4-4Z",route:"/settings",dividerAbove:!0},{label:"Cerrar Sesi\xF3n",icon:"M16 13H7v-2h9V8l5 4-5 4v-3Z",danger:!0,dividerAbove:!0,action:()=>this.logout()}];toggleSidebar(){this.sidebarOpen.update(t=>!t)}closeSidebar(){this.sidebarOpen.set(!1)}toggleUserMenu(){this.userMenuOpen.update(t=>!t)}closeUserMenu(){this.userMenuOpen.set(!1)}handleMenuItem(t){t.action&&t.action(),this.closeUserMenu()}logout(){this.authService.signOut()?(console.log("Sesi\xF3n cerrada exitosamente"),this.router.navigate(["/auth/login"])):console.error("Error al cerrar sesi\xF3n")}onDocClick(t){t.target.closest(".relative")||this.closeUserMenu()}static \u0275fac=function(e){return new(e||i)(O(Ct),O(kt))};static \u0275cmp=D({type:i,selectors:[["app-main-layout"]],hostBindings:function(e,n){e&1&&x("click",function(s){return n.onDocClick(s)},hn)},decls:33,vars:9,consts:[[1,"min-h-dvh","bg-gray-50","text-gray-900"],[1,"sticky","top-0","z-40","bg-white/90","backdrop-blur","border-b","shadow-sm"],[1,"mx-auto","w-full","max-w-7xl","px-3","md:px-6","lg:px-8"],[1,"flex","h-16","items-center","gap-2"],[1,"flex","items-center","gap-2"],[1,"inline-flex","h-9","w-9","items-center","justify-center","rounded-lg","border","bg-white","hover:bg-gray-100","transition","md:hidden",3,"click"],["viewBox","0 0 24 24","fill","none","stroke","currentColor",1,"h-5","w-5"],["stroke-linecap","round","stroke-width","2","d","M4 7h16M4 12h16M4 17h16"],["routerLink","/",1,"text-base","font-semibold","text-teal-900","hover:text-teal-700","transition"],[1,"ml-auto","relative"],[1,"flex","items-center","gap-2","rounded-lg","px-2","py-1","hover:bg-gray-100","transition",3,"click"],[1,"h-8","w-8","rounded-full","bg-teal-700","text-white","text-sm","flex","items-center","justify-center"],[1,"hidden","sm:block","text-left"],[1,"text-sm","font-medium","text-teal-900"],[1,"text-xs","text-teal-700","capitalize"],["fill","currentColor",1,"h-4","w-4","text-teal-700"],["d","M7 10l5 5 5-5z"],[1,"absolute","right-0","mt-2","w-64","rounded-xl","border","bg-white","shadow-lg"],[1,"flex"],[1,"fixed","inset-y-0","left-0","z-40","w-64","bg-white","border-r","shadow-md","transition-transform","md:static","md:translate-x-0"],[1,"flex","flex-col","gap-2","p-3"],["routerLinkActive","bg-teal-700 text-white",1,"flex","items-center","gap-3","rounded-xl","px-3","py-2","text-sm","hover:bg-teal-100","transition",3,"routerLink"],[1,"fixed","inset-0","z-30","bg-black/20","md:hidden"],[1,"flex-1","min-h-[calc(100dvh-64px)]","bg-gray-50"],[1,"md:border-l"],[1,"max-w-7xl","mx-auto","px-4","pb-10"],[1,"flex","items-center","gap-3","px-4","py-3"],[1,"h-9","w-9","rounded-full","bg-teal-700","text-white","text-sm","flex","items-center","justify-center"],[1,"text-sm","font-semibold","text-teal-900"],[1,"h-px","bg-gray-100"],[1,"flex","w-full","items-center","gap-3","px-4","py-2.5","text-sm","hover:bg-gray-50","transition",3,"click","routerLink"],[1,"h-8","w-8","rounded-lg","border","bg-white","flex","items-center","justify-center"],["viewBox","0 0 24 24","fill","currentColor",1,"h-4","w-4"],["routerLinkActive","bg-teal-700 text-white",1,"flex","items-center","gap-3","rounded-xl","px-3","py-2","text-sm","hover:bg-teal-100","transition",3,"click","routerLink"],[1,"h-9","w-9","rounded-lg","bg-teal-50","flex","items-center","justify-center","group-[.router-link-active]:bg-teal-700"],["viewBox","0 0 24 24","fill","currentColor",1,"h-5","w-5","text-teal-700","group-[.router-link-active]:text-white"],[1,"fixed","inset-0","z-30","bg-black/20","md:hidden",3,"click"]],template:function(e,n){e&1&&(o(0,"div",0)(1,"header",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"button",5),x("click",function(){return n.toggleSidebar()}),R(),o(6,"svg",6),I(7,"path",7),a()(),ie(),o(8,"a",8),c(9,"Sistema de Citas"),a()(),o(10,"div",9)(11,"button",10),x("click",function(){return n.toggleUserMenu()}),o(12,"span",11),c(13),a(),o(14,"div",12)(15,"div",13),c(16),a(),o(17,"div",14),c(18),a()(),R(),o(19,"svg",15),I(20,"path",16),a()(),$(21,Jc,12,3,"div",17),a()()()(),ie(),o(22,"div",18)(23,"aside",19)(24,"nav",20),De(25,Zc,5,3,"a",21,zc),a()(),$(27,Kc,1,0,"div",22),o(28,"main",23)(29,"div",24)(30,"div",25),I(31,"router-outlet"),a()()()(),I(32,"app-chat-widget"),a()),e&2&&(l(13),E(" ",n.userInitial()," "),l(3),y(n.userName()),l(2),y(n.userRole().toLowerCase()),l(3),z(n.userMenuOpen()?21:-1),l(2),pi("-translate-x-full",!n.sidebarOpen())("translate-x-0",n.sidebarOpen()),l(2),Ae(n.navItems()),l(2),z(n.sidebarOpen()?27:-1))},dependencies:[H,Sn,yt,Cn,wn,Yt],encapsulation:2})};var Qc=()=>[5,8,12,7,10,15,9],Yc=()=>[3,5,7,6,4,8,5],el=()=>[1,2,1,3,2,1,2];function tl(i,t){if(i&1&&I(0,"div",26),i&2){let e=t.$implicit;bt("height",e*5,"%")}}function il(i,t){if(i&1&&I(0,"div",27),i&2){let e=t.$implicit;bt("height",e*10,"%")}}function nl(i,t){if(i&1&&I(0,"div",28),i&2){let e=t.$implicit;bt("height",e*20,"%")}}var ti=class i{static \u0275fac=function(e){return new(e||i)};static \u0275cmp=D({type:i,selectors:[["app-dashboard"]],decls:47,vars:6,consts:[[1,"space-y-8","p-6","bg-gray-50","min-h-screen"],[1,"flex","flex-col","sm:flex-row","sm:items-center","sm:justify-between","gap-2"],[1,"text-3xl","font-extrabold","text-teal-900"],[1,"text-teal-700"],[1,"grid","grid-cols-1","sm:grid-cols-2","lg:grid-cols-3","gap-6"],[1,"p-6","rounded-2xl","bg-gradient-to-r","from-teal-400","to-teal-300","text-white","shadow-md","transform","transition","hover:scale-105","cursor-pointer"],[1,"flex","items-center","justify-between"],[1,"text-sm","font-medium"],["fill","currentColor","viewBox","0 0 24 24",1,"h-6","w-6","text-white","opacity-80"],["d","M12 12a5 5 0 1 0-5-5 5 5 0 0 0 5 5Zm0 2c-4 0-7 2-7 4v2h14v-2c0-2-3-4-7-4Z"],[1,"mt-3","text-3xl","font-bold"],[1,"p-6","rounded-2xl","bg-gradient-to-r","from-cyan-400","to-cyan-300","text-white","shadow-md","transform","transition","hover:scale-105","cursor-pointer"],["d","M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2z"],[1,"p-6","rounded-2xl","bg-gradient-to-r","from-lime-400","to-lime-300","text-white","shadow-md","transform","transition","hover:scale-105","cursor-pointer"],["d","M12 12a5 5 0 1 0-5-5 5 5 0 0 0 5 5Zm-7 9v-1c0-2.76 3.58-5 8-5s8 2.24 8 5v1H5Zm13-11h-2V8a1 1 0 1 0-2 0v2h-2a1 1 0 1 0 0 2h2v2a1 1 0 1 0 2 0v-2h2a1 1 0 1 0 0-2Z"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-3","gap-6","mt-6"],[1,"p-6","bg-white","rounded-2xl","shadow-sm"],[1,"text-teal-900","font-semibold","mb-3"],[1,"h-40","bg-teal-50","rounded-lg","flex","items-end","gap-1","p-2"],["class","bg-teal-400 w-6 rounded-t-lg",3,"height",4,"ngFor","ngForOf"],[1,"text-cyan-900","font-semibold","mb-3"],[1,"h-40","bg-cyan-50","rounded-lg","flex","items-end","gap-1","p-2"],["class","bg-cyan-400 w-6 rounded-t-lg",3,"height",4,"ngFor","ngForOf"],[1,"text-lime-900","font-semibold","mb-3"],[1,"h-40","bg-lime-50","rounded-lg","flex","items-end","gap-1","p-2"],["class","bg-lime-400 w-6 rounded-t-lg",3,"height",4,"ngFor","ngForOf"],[1,"bg-teal-400","w-6","rounded-t-lg"],[1,"bg-cyan-400","w-6","rounded-t-lg"],[1,"bg-lime-400","w-6","rounded-t-lg"]],template:function(e,n){e&1&&(o(0,"div",0)(1,"div",1)(2,"h1",2),c(3,"Dashboard Cl\xEDnica"),a(),o(4,"p",3),c(5,"Bienvenido al sistema de Clinica de Vida"),a()(),o(6,"div",4)(7,"div",5)(8,"div",6)(9,"div",7),c(10,"Pacientes Hoy"),a(),R(),o(11,"svg",8),I(12,"path",9),a()(),ie(),o(13,"div",10),c(14,"123"),a()(),o(15,"div",11)(16,"div",6)(17,"div",7),c(18,"Citas Pr\xF3ximas"),a(),R(),o(19,"svg",8),I(20,"path",12),a()(),ie(),o(21,"div",10),c(22,"45"),a()(),o(23,"div",13)(24,"div",6)(25,"div",7),c(26,"Doctores Disponibles"),a(),R(),o(27,"svg",8),I(28,"path",14),a()(),ie(),o(29,"div",10),c(30,"12"),a()()(),o(31,"div",15)(32,"div",16)(33,"h3",17),c(34,"Pacientes por Mes"),a(),o(35,"div",18),S(36,tl,1,2,"div",19),a()(),o(37,"div",16)(38,"h3",20),c(39,"Citas Semanales"),a(),o(40,"div",21),S(41,il,1,2,"div",22),a()(),o(42,"div",16)(43,"h3",23),c(44,"Doctores Activos"),a(),o(45,"div",24),S(46,nl,1,2,"div",25),a()()()()),e&2&&(l(36),f("ngForOf",vt(3,Qc)),l(5),f("ngForOf",vt(4,Yc)),l(5),f("ngForOf",vt(5,el)))},dependencies:[H,ne],encapsulation:2})};var Ca=(i,t)=>{let e=V(Ct),n=V(kt);return t.url.includes("/login")?Ge(!0):n.check().pipe(pn(r=>{if(!r){let s=e.parseUrl("/auth/login");return Ge(s)}return Ge(!0)}),un(r=>{console.error("Authentication check failed",r);let s=e.parseUrl("/auth/login");return Ge(s)}))};var ii=class i{_httpClient=V(W);baseUrl=q.apiUrl;getCitas(t=0,e=5){return this._httpClient.get(`${this.baseUrl}/api/citas?page=${t}&size=${e}`)}crearCita(t){return this._httpClient.post(`${this.baseUrl}/api/citas`,t)}actualizarCita(t,e){return this._httpClient.put(`${this.baseUrl}/api/citas/${t}`,e)}eliminarCita(t){return this._httpClient.delete(`${this.baseUrl}/api/citas/${t}`)}static \u0275fac=function(e){return new(e||i)};static \u0275prov=Z({token:i,factory:i.\u0275fac,providedIn:"root"})};var $e=class i{_httpClient=V(W);baseUrl=q.apiUrl;getPacientes(t=0,e=1e3){return this._httpClient.get(`${this.baseUrl}/api/pacientes?page=${t}&size=${e}`)}getPacienteById(t){return this._httpClient.get(`${this.baseUrl}/api/pacientes${t}`)}createPaciente(t){return this._httpClient.post(this.baseUrl,t)}updatePaciente(t,e){return this._httpClient.put(`${this.baseUrl}/${t}`,e)}deletePaciente(t){return this._httpClient.delete(`${this.baseUrl}/${t}`)}static \u0275fac=function(e){return new(e||i)};static \u0275prov=Z({token:i,factory:i.\u0275fac,providedIn:"root"})};var ze=class i{constructor(t){this.http=t}_httpClient=V(W);baseUrl=q.apiUrl;getMedicos(t=0,e=1e3){return this._httpClient.get(`${this.baseUrl}/api/medicos?page=${t}&size=${e}`)}static \u0275fac=function(e){return new(e||i)(ht(W))};static \u0275prov=Z({token:i,factory:i.\u0275fac,providedIn:"root"})};var Sa=(i,t,e)=>({"bg-yellow-100 text-yellow-700 px-3 py-1 rounded-full text-xs font-semibold":i,"bg-green-100 text-green-700 px-3 py-1 rounded-full text-xs font-semibold":t,"bg-red-100 text-red-700 px-3 py-1 rounded-full text-xs font-semibold":e});function al(i,t){if(i&1&&(o(0,"option",28),c(1),a()),i&2){let e=t.$implicit;f("value",e.id),l(),K("",e.nombres," ",e.apellidos)}}function sl(i,t){if(i&1&&(o(0,"option",28),c(1),a()),i&2){let e=t.$implicit;f("value",e.id),l(),K("",e.nombres," ",e.apellidos)}}function cl(i,t){if(i&1){let e=k();o(0,"div",13)(1,"div",14)(2,"h3",15),c(3,"Nueva Cita M\xE9dica"),a(),o(4,"form",16),x("ngSubmit",function(){b(e);let r=h();return v(r.guardarCita())}),o(5,"label",17),c(6,"Paciente:"),a(),o(7,"select",18),F("ngModelChange",function(r){b(e);let s=h();return j(s.cita.pacienteId,r)||(s.cita.pacienteId=r),v(r)}),o(8,"option",19),c(9,"Seleccionar paciente..."),a(),S(10,al,2,3,"option",20),a(),o(11,"label",17),c(12,"M\xE9dico:"),a(),o(13,"select",21),F("ngModelChange",function(r){b(e);let s=h();return j(s.cita.medicoId,r)||(s.cita.medicoId=r),v(r)}),o(14,"option",19),c(15,"Seleccionar m\xE9dico..."),a(),S(16,sl,2,3,"option",20),a(),o(17,"label",17),c(18,"Fecha:"),a(),o(19,"input",22),F("ngModelChange",function(r){b(e);let s=h();return j(s.cita.fecha,r)||(s.cita.fecha=r),v(r)}),a(),o(20,"label",17),c(21,"Hora:"),a(),o(22,"input",23),F("ngModelChange",function(r){b(e);let s=h();return j(s.cita.hora,r)||(s.cita.hora=r),v(r)}),a(),o(23,"label",17),c(24,"Motivo:"),a(),o(25,"input",24),F("ngModelChange",function(r){b(e);let s=h();return j(s.cita.motivo,r)||(s.cita.motivo=r),v(r)}),a(),o(26,"div",25)(27,"button",26),x("click",function(){b(e);let r=h();return v(r.cerrarFormularioCita())}),c(28,"Cancelar"),a(),o(29,"button",27),c(30,"Guardar"),a()()()()()}if(i&2){let e=h();l(7),L("ngModel",e.cita.pacienteId),l(3),f("ngForOf",e.pacientes),l(3),L("ngModel",e.cita.medicoId),l(3),f("ngForOf",e.medicos),l(3),L("ngModel",e.cita.fecha),l(3),L("ngModel",e.cita.hora),l(3),L("ngModel",e.cita.motivo)}}function ll(i,t){if(i&1&&(o(0,"option",28),c(1),a()),i&2){let e=t.$implicit;f("value",e.id),l(),K("",e.nombres," ",e.apellidos)}}function dl(i,t){if(i&1&&(o(0,"option",28),c(1),a()),i&2){let e=t.$implicit;f("value",e.id),l(),K("",e.nombres," ",e.apellidos)}}function ul(i,t){if(i&1){let e=k();o(0,"div",13)(1,"div",14)(2,"h3",15),c(3,"\u270F\uFE0F Editar Cita M\xE9dica"),a(),o(4,"form",16),x("ngSubmit",function(){b(e);let r=h();return v(r.guardarEdicion())}),o(5,"label",17),c(6,"Paciente:"),a(),o(7,"select",29),F("ngModelChange",function(r){b(e);let s=h();return j(s.editingCita.idPaciente,r)||(s.editingCita.idPaciente=r),v(r)}),o(8,"option",19),c(9,"Seleccionar paciente..."),a(),S(10,ll,2,3,"option",20),a(),o(11,"label",17),c(12,"M\xE9dico:"),a(),o(13,"select",30),F("ngModelChange",function(r){b(e);let s=h();return j(s.editingCita.idMedico,r)||(s.editingCita.idMedico=r),v(r)}),o(14,"option",19),c(15,"Seleccionar m\xE9dico..."),a(),S(16,dl,2,3,"option",20),a(),o(17,"label",17),c(18,"Fecha:"),a(),o(19,"input",22),F("ngModelChange",function(r){b(e);let s=h();return j(s.editingCita.fecha,r)||(s.editingCita.fecha=r),v(r)}),a(),o(20,"label",17),c(21,"Hora:"),a(),o(22,"input",23),F("ngModelChange",function(r){b(e);let s=h();return j(s.editingCita.hora,r)||(s.editingCita.hora=r),v(r)}),a(),o(23,"label",17),c(24,"Motivo:"),a(),o(25,"input",24),F("ngModelChange",function(r){b(e);let s=h();return j(s.editingCita.motivo,r)||(s.editingCita.motivo=r),v(r)}),a(),o(26,"label",17),c(27,"Estado:"),a(),o(28,"select",31),F("ngModelChange",function(r){b(e);let s=h();return j(s.editingCita.estado,r)||(s.editingCita.estado=r),v(r)}),o(29,"option",32),c(30,"PENDIENTE"),a(),o(31,"option",33),c(32,"CONFIRMADA"),a(),o(33,"option",34),c(34,"CANCELADA"),a()(),o(35,"div",25)(36,"button",26),x("click",function(){b(e);let r=h();return v(r.cancelarEdicion())}),c(37,"Cancelar"),a(),o(38,"button",35),c(39,"Actualizar"),a()()()()()}if(i&2){let e=h();l(7),L("ngModel",e.editingCita.idPaciente),l(3),f("ngForOf",e.pacientes),l(3),L("ngModel",e.editingCita.idMedico),l(3),f("ngForOf",e.medicos),l(3),L("ngModel",e.editingCita.fecha),l(3),L("ngModel",e.editingCita.hora),l(3),L("ngModel",e.editingCita.motivo),l(3),L("ngModel",e.editingCita.estado)}}function pl(i,t){if(i&1){let e=k();o(0,"div",13)(1,"div",36)(2,"h3",37),c(3,"\u{1F5D1}\uFE0F Eliminar Cita"),a(),o(4,"p",38),c(5," \xBFEst\xE1s seguro de que deseas eliminar la cita de "),o(6,"strong"),c(7),a(),c(8," programada para el "),o(9,"strong"),c(10),a(),c(11," a las "),o(12,"strong"),c(13),a(),c(14,"? "),a(),o(15,"p",39),c(16,"Esta acci\xF3n no se puede deshacer."),a(),o(17,"div",40)(18,"button",26),x("click",function(){b(e);let r=h();return v(r.cancelarEliminacion())}),c(19," Cancelar "),a(),o(20,"button",41),x("click",function(){b(e);let r=h();return v(r.confirmarEliminacion())}),c(21," S\xED, Eliminar "),a()()()()}if(i&2){let e=h();l(7),y(e.citaAEliminar.pacienteNombreCompleto),l(3),y(e.citaAEliminar.fecha),l(3),y(e.citaAEliminar.hora==null?null:e.citaAEliminar.hora.substring(0,5))}}function ml(i,t){i&1&&(o(0,"div",42),c(1," \u23F3 Cargando citas... "),a())}function hl(i,t){if(i&1&&(o(0,"div",43),c(1),a()),i&2){let e=h();l(),E(" ",e.successMessage," ")}}function fl(i,t){if(i&1&&(o(0,"div",44),c(1),a()),i&2){let e=h();l(),E(" ",e.editMessage," ")}}function gl(i,t){if(i&1&&(o(0,"div",45),c(1),a()),i&2){let e=h();l(),E(" ",e.deleteMessage," ")}}function bl(i,t){if(i&1){let e=k();o(0,"tr",60)(1,"td",61),c(2),hi(3,"date"),a(),o(4,"td",62),c(5),a(),o(6,"td",62),c(7),a(),o(8,"td",62),c(9),a(),o(10,"td",62),c(11),a(),o(12,"td",62),c(13),a(),o(14,"td",62)(15,"span",63),c(16),a()(),o(17,"td",62)(18,"div",64)(19,"button",65),x("click",function(){let r=b(e).$implicit,s=h(4);return v(s.abrirEdicion(r))}),R(),o(20,"svg",66),I(21,"path",67),a()(),ie(),o(22,"button",68),x("click",function(){let r=b(e).$implicit,s=h(4);return v(s.abrirConfirmacionEliminar(r))}),R(),o(23,"svg",66),I(24,"path",69),a()()()()()}if(i&2){let e=t.$implicit;l(2),y(fi(3,8,e.fecha,"dd/MM/yy")),l(3),y(e.hora.substring(0,5)),l(2),y(e.pacienteNombreCompleto),l(2),y(e.especialidad),l(2),y(e.medicoNombreCompleto),l(2),y(e.motivo),l(2),f("ngClass",mi(11,Sa,e.estado==="PENDIENTE",e.estado==="CONFIRMADA",e.estado==="CANCELADA")),l(),E(" ",e.estado," ")}}function vl(i,t){if(i&1&&(o(0,"div",53)(1,"div",54)(2,"table",55)(3,"thead",56)(4,"tr")(5,"th",57),c(6,"Fecha"),a(),o(7,"th",57),c(8,"Hora"),a(),o(9,"th",57),c(10,"Paciente"),a(),o(11,"th",57),c(12,"Especialidad"),a(),o(13,"th",57),c(14,"M\xE9dico"),a(),o(15,"th",57),c(16,"Motivo"),a(),o(17,"th",57),c(18,"Estado"),a(),o(19,"th",57),c(20,"Acciones"),a()()(),o(21,"tbody",58),S(22,bl,25,15,"tr",59),a()()()()),i&2){let e=h(3);l(22),f("ngForOf",e.citas)}}function _l(i,t){if(i&1){let e=k();o(0,"div",72)(1,"div",73)(2,"h3",74),c(3),a(),o(4,"span",63),c(5),a()(),o(6,"p",75)(7,"b"),c(8,"Fecha:"),a(),c(9),hi(10,"date"),a(),o(11,"p",75)(12,"b"),c(13,"Hora:"),a(),c(14),a(),o(15,"p",75)(16,"b"),c(17,"Especialidad:"),a(),c(18),a(),o(19,"p",75)(20,"b"),c(21,"M\xE9dico:"),a(),c(22),a(),o(23,"p",75)(24,"b"),c(25,"Motivo:"),a(),c(26),a(),o(27,"div",76)(28,"button",65),x("click",function(){let r=b(e).$implicit,s=h(4);return v(s.abrirEdicion(r))}),R(),o(29,"svg",66),I(30,"path",67),a()(),ie(),o(31,"button",68),x("click",function(){let r=b(e).$implicit,s=h(4);return v(s.abrirConfirmacionEliminar(r))}),R(),o(32,"svg",66),I(33,"path",69),a()()()()}if(i&2){let e=t.$implicit;l(3),y(e.pacienteNombreCompleto),l(),f("ngClass",mi(11,Sa,e.estado==="PENDIENTE",e.estado==="CONFIRMADA",e.estado==="CANCELADA")),l(),E(" ",e.estado," "),l(4),E(" ",fi(10,8,e.fecha,"dd/MM/yy")),l(5),E(" ",e.hora),l(4),E(" ",e.especialidad),l(4),E(" ",e.medicoNombreCompleto),l(4),E(" ",e.motivo)}}function xl(i,t){if(i&1&&(o(0,"div",70),S(1,_l,34,15,"div",71),a()),i&2){let e=h(3);l(),f("ngForOf",e.citas)}}function yl(i,t){if(i&1){let e=k();o(0,"div"),S(1,vl,23,1,"div",47)(2,xl,2,1,"div",48),o(3,"div",49)(4,"button",50),x("click",function(){b(e);let r=h(2);return v(r.prevPage())}),c(5," \u2B05 Anterior "),a(),o(6,"span",51),c(7),a(),o(8,"button",52),x("click",function(){b(e);let r=h(2);return v(r.nextPage())}),c(9," Siguiente \u27A1 "),a()()()}if(i&2){let e=h(2);l(),f("ngIf",e.viewMode==="table"),l(),f("ngIf",e.viewMode==="cards"),l(2),f("disabled",e.currentPage===0),l(3),K(" P\xE1gina ",e.currentPage+1," de ",e.totalPages," "),l(),f("disabled",e.currentPage>=e.totalPages-1)}}function Cl(i,t){if(i&1&&S(0,yl,10,6,"div",46),i&2){let e=h(),n=gt(18);f("ngIf",e.citas.length>0)("ngIfElse",n)}}function wl(i,t){i&1&&(o(0,"div",77)(1,"p",78),c(2,"No hay citas registradas \u{1F5D2}"),a(),o(3,"p",79),c(4,"Puedes agregar una nueva cita desde el bot\xF3n "),o(5,"b"),c(6,'"+ Nueva Cita"'),a(),c(7,"."),a()())}var ni=class i{constructor(t,e,n,r){this.citaService=t;this.cdr=e;this.pacienteService=n;this.medicoService=r}mostrarFormulario=!1;citas=[];pacientes=[];medicos=[];especialidades=[];totalPages=0;currentPage=0;size=6;loading=!1;successMessage=null;editMessage=null;deleteMessage=null;editingCita=null;citaAEliminar=null;cita={pacienteId:null,medicoId:null,fecha:"",hora:"",motivo:""};viewMode="table";ngOnInit(){this.loadCitas(),this.cargarPacientes(),this.cargarMedicos()}cargarPacientes(){this.pacienteService.getPacientes(0,1e3).subscribe(t=>{this.pacientes=t.content??[],console.log("Pacientes cargados:",this.pacientes),this.cdr.detectChanges()})}cargarMedicos(){this.medicoService.getMedicos(0,1e3).subscribe(t=>{this.medicos=t.content??[],console.log("M\xE9dicos cargados:",this.medicos),this.cdr.detectChanges()})}loadCitas(t=0){this.loading=!0,this.citaService.getCitas(t,this.size).subscribe({next:e=>{this.citas=e.content,console.log("Citas cargadas:",this.citas),this.totalPages=e.totalPages,this.currentPage=e.number,this.loading=!1,this.cdr.detectChanges()},error:e=>{console.error("Error cargando citas",e),this.loading=!1,this.cdr.detectChanges()}})}prevPage(){this.currentPage>0&&this.loadCitas(this.currentPage-1)}nextPage(){this.currentPage<this.totalPages-1&&this.loadCitas(this.currentPage+1)}toggleView(){this.viewMode=this.viewMode==="table"?"cards":"table"}abrirFormularioCita(){this.cita={pacienteId:null,medicoId:null,fecha:"",hora:"",motivo:""},this.mostrarFormulario=!0,this.editingCita=null}cerrarFormularioCita(){this.mostrarFormulario=!1}guardarCita(){let t={fecha:this.cita.fecha,hora:this.cita.hora+":00",motivo:this.cita.motivo,estado:"PENDIENTE",paciente:{id:this.cita.pacienteId},medico:{id:this.cita.medicoId}};this.citaService.crearCita(t).subscribe({next:()=>{this.successMessage="\xA1Cita registrada con \xE9xito! \u{1F389}",setTimeout(()=>this.successMessage=null,4e3),this.cerrarFormularioCita(),this.loadCitas(this.currentPage)},error:e=>{console.error("Error al crear cita:",e)}})}abrirEdicion(t){console.log("Cita a editar:",t);let e=t.hora?t.hora.substring(0,5):"",n=t.idPaciente,r=t.idMedico;console.log("PacienteId encontrado:",n),console.log("MedicoId encontrado:",r),this.editingCita=cn(sn({},t),{idPaciente:n,idMedico:r,hora:e}),console.log("EditingCita:",this.editingCita),this.mostrarFormulario=!1}guardarEdicion(){if(!this.editingCita)return;let t={fecha:this.editingCita.fecha,hora:this.editingCita.hora+":00",motivo:this.editingCita.motivo,estado:this.editingCita.estado,paciente:{id:this.editingCita.idPaciente},medico:{id:this.editingCita.idMedico}};this.citaService.actualizarCita(this.editingCita.id,t).subscribe({next:()=>{this.editMessage="\u2705 Cita actualizada con \xE9xito",setTimeout(()=>this.editMessage=null,4e3),this.editingCita=null,this.loadCitas(this.currentPage)},error:e=>{console.error("\u274C Error al actualizar cita:",e)}})}cancelarEdicion(){this.editingCita=null}abrirConfirmacionEliminar(t){this.citaAEliminar=t,this.mostrarFormulario=!1,this.editingCita=null}confirmarEliminacion(){this.citaAEliminar&&this.citaService.eliminarCita(this.citaAEliminar.id).subscribe({next:()=>{this.deleteMessage="\u{1F5D1}\uFE0F Cita eliminada correctamente",setTimeout(()=>this.deleteMessage=null,4e3),this.citaAEliminar=null,this.citas.length===1&&this.currentPage>0?this.loadCitas(this.currentPage-1):this.loadCitas(this.currentPage)},error:t=>{console.error("Error al eliminar cita:",t);let e="Error al eliminar la cita";t.status===500?e="No se puede eliminar: La cita tiene dependencias o est\xE1 siendo referenciada":t.status===404?e="La cita no existe o ya fue eliminada":t.status===403?e="No tienes permisos para eliminar esta cita":t.error?.message&&(e=`Error: ${t.error.message}`),this.deleteMessage=e,setTimeout(()=>this.deleteMessage=null,6e3),this.citaAEliminar=null}})}cancelarEliminacion(){this.citaAEliminar=null}static \u0275fac=function(e){return new(e||i)(O(ii),O(ve),O($e),O(ze))};static \u0275cmp=D({type:i,selectors:[["app-cita-medica"]],decls:19,vars:9,consts:[["emptyTpl",""],[1,"container","mx-auto","px-6","py-8"],[1,"flex","items-center","justify-between","mb-6"],[1,"text-3xl","font-extrabold","text-gray-800","tracking-tight"],[1,"flex","gap-3"],[1,"px-4","py-2","bg-indigo-600","hover:bg-indigo-700","text-white","text-sm","font-medium","rounded-xl","shadow-md","transition",3,"click"],[1,"px-4","py-2","bg-blue-600","hover:bg-blue-700","text-white","text-sm","font-medium","rounded-xl","shadow-md","transition",3,"click"],["class","fixed inset-0 bg-gray-800 bg-opacity-50 flex justify-center items-center z-50",4,"ngIf"],["class","text-center text-gray-500 py-10",4,"ngIf"],["class","mb-4 p-4 bg-green-100 border border-green-300 text-green-700 rounded-lg shadow-sm",4,"ngIf"],["class","mb-4 p-4 bg-blue-100 border border-blue-300 text-blue-700 rounded-lg shadow-sm",4,"ngIf"],["class","mb-4 p-4 bg-red-100 border border-red-300 text-red-700 rounded-lg shadow-sm",4,"ngIf"],[3,"ngIf"],[1,"fixed","inset-0","bg-gray-800","bg-opacity-50","flex","justify-center","items-center","z-50"],[1,"bg-white","p-6","rounded-lg","shadow-xl","w-96","max-h-screen","overflow-y-auto"],[1,"text-lg","font-bold","mb-4"],[3,"ngSubmit"],[1,"block","mb-2","font-medium"],["name","pacienteId","required","",1,"w-full","mb-3","border","border-gray-300","px-3","py-2","rounded-lg","focus:ring-2","focus:ring-blue-500",3,"ngModelChange","ngModel"],["value",""],[3,"value",4,"ngFor","ngForOf"],["name","medicoId","required","",1,"w-full","mb-3","border","border-gray-300","px-3","py-2","rounded-lg","focus:ring-2","focus:ring-blue-500",3,"ngModelChange","ngModel"],["type","date","name","fecha","required","",1,"w-full","mb-3","border","border-gray-300","px-3","py-2","rounded-lg","focus:ring-2","focus:ring-blue-500",3,"ngModelChange","ngModel"],["type","time","name","hora","required","",1,"w-full","mb-3","border","border-gray-300","px-3","py-2","rounded-lg","focus:ring-2","focus:ring-blue-500",3,"ngModelChange","ngModel"],["type","text","name","motivo","required","",1,"w-full","mb-3","border","border-gray-300","px-3","py-2","rounded-lg","focus:ring-2","focus:ring-blue-500",3,"ngModelChange","ngModel"],[1,"flex","justify-end","mt-6","gap-3"],["type","button",1,"px-4","py-2","bg-gray-400","hover:bg-gray-500","text-white","rounded-lg","transition",3,"click"],["type","submit",1,"px-4","py-2","bg-blue-600","hover:bg-blue-700","text-white","rounded-lg","transition"],[3,"value"],["name","idPaciente","required","",1,"w-full","mb-3","border","border-gray-300","px-3","py-2","rounded-lg","focus:ring-2","focus:ring-blue-500",3,"ngModelChange","ngModel"],["name","idMedico","required","",1,"w-full","mb-3","border","border-gray-300","px-3","py-2","rounded-lg","focus:ring-2","focus:ring-blue-500",3,"ngModelChange","ngModel"],["name","estado","required","",1,"w-full","mb-3","border","border-gray-300","px-3","py-2","rounded-lg","focus:ring-2","focus:ring-blue-500",3,"ngModelChange","ngModel"],["value","PENDIENTE"],["value","CONFIRMADA"],["value","CANCELADA"],["type","submit",1,"px-4","py-2","bg-green-600","hover:bg-green-700","text-white","rounded-lg","transition"],[1,"bg-white","p-6","rounded-lg","shadow-xl","w-96"],[1,"text-lg","font-bold","mb-4","text-red-600"],[1,"text-gray-700","mb-4"],[1,"text-sm","text-red-500","mb-6"],[1,"flex","justify-end","gap-3"],["type","button",1,"px-4","py-2","bg-red-600","hover:bg-red-700","text-white","rounded-lg","transition",3,"click"],[1,"text-center","text-gray-500","py-10"],[1,"mb-4","p-4","bg-green-100","border","border-green-300","text-green-700","rounded-lg","shadow-sm"],[1,"mb-4","p-4","bg-blue-100","border","border-blue-300","text-blue-700","rounded-lg","shadow-sm"],[1,"mb-4","p-4","bg-red-100","border","border-red-300","text-red-700","rounded-lg","shadow-sm"],[4,"ngIf","ngIfElse"],["class","bg-white/70 backdrop-blur-lg rounded-2xl shadow-lg overflow-hidden border border-gray-100",4,"ngIf"],["class","grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",4,"ngIf"],[1,"flex","justify-between","items-center","p-4","mt-6","bg-gray-50","border","rounded-xl"],[1,"flex","items-center","gap-2","px-4","py-2","bg-gray-200","hover:bg-gray-300","rounded-xl","text-sm","font-medium","transition","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],[1,"text-gray-600","font-medium"],[1,"flex","items-center","gap-2","px-4","py-2","bg-blue-600","hover:bg-blue-700","text-white","rounded-xl","text-sm","font-medium","shadow-md","transition","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],[1,"bg-white/70","backdrop-blur-lg","rounded-2xl","shadow-lg","overflow-hidden","border","border-gray-100"],[1,"overflow-x-auto"],[1,"w-full","text-sm","text-left","text-gray-700"],[1,"bg-gradient-to-r","from-blue-600","to-blue-500","text-white","uppercase","text-xs","tracking-wider"],[1,"px-6","py-3"],[1,"divide-y","divide-gray-200"],["class","hover:bg-gray-50 transition",4,"ngFor","ngForOf"],[1,"hover:bg-gray-50","transition"],[1,"px-6","py-4","font-medium","text-gray-900"],[1,"px-6","py-4"],[3,"ngClass"],[1,"flex","gap-2"],["title","Editar cita",1,"flex","items-center","gap-1","px-3","py-1.5","bg-yellow-100","text-yellow-700","hover:bg-yellow-200","rounded-full","shadow-sm","text-xs","font-medium","transition",3,"click"],["xmlns","http://www.w3.org/2000/svg","fill","currentColor","viewBox","0 0 24 24",1,"w-4","h-4"],["d","M16.862 4.487l2.651 2.65a.75.75 0 010 1.06L9.92 17.79l-3.713.53a.75.75 0 01-.848-.848l.53-3.713 9.593-9.593a.75.75 0 011.06 0z"],["title","Eliminar cita",1,"flex","items-center","gap-1","px-3","py-1.5","bg-red-100","text-red-700","hover:bg-red-200","rounded-full","shadow-sm","text-xs","font-medium","transition",3,"click"],["fill-rule","evenodd","d","M16.5 4.5v-.75A2.25 2.25 0 0014.25 1.5h-4.5A2.25 2.25 0 007.5 3.75v.75H3.75a.75.75 0 000 1.5h16.5a.75.75 0 000-1.5H16.5zm-10.125 3l.597 12.009A2.25 2.25 0 009.218 22.5h5.564a2.25 2.25 0 002.246-2.991L17.625 7.5H6.375z","clip-rule","evenodd"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-3","gap-6"],["class","bg-white rounded-2xl shadow-lg border border-gray-200 p-6 hover:shadow-xl transition",4,"ngFor","ngForOf"],[1,"bg-white","rounded-2xl","shadow-lg","border","border-gray-200","p-6","hover:shadow-xl","transition"],[1,"flex","justify-between","items-center","mb-4"],[1,"text-lg","font-bold","text-gray-800"],[1,"text-sm","text-gray-600"],[1,"mt-4","flex","justify-end","gap-2"],[1,"text-center","text-gray-500","mt-10","bg-gray-100","py-10","rounded-xl","shadow-inner"],[1,"text-lg","font-medium"],[1,"text-sm"]],template:function(e,n){if(e&1){let r=k();o(0,"div",1)(1,"div",2)(2,"h2",3),c(3," \u{1F4C5} Citas M\xE9dicas "),a(),o(4,"div",4)(5,"button",5),x("click",function(){return b(r),v(n.toggleView())}),c(6),a(),o(7,"button",6),x("click",function(){return b(r),v(n.abrirFormularioCita())}),c(8," + Nueva Cita "),a()()(),S(9,cl,31,7,"div",7)(10,ul,40,8,"div",7)(11,pl,22,3,"div",7)(12,ml,2,0,"div",8)(13,hl,2,1,"div",9)(14,fl,2,1,"div",10)(15,gl,2,1,"div",11)(16,Cl,1,2,"ng-template",12)(17,wl,8,0,"ng-template",null,0,_t),a()}e&2&&(l(6),E(" Cambiar a ",n.viewMode==="table"?"Cards":"Tabla"," "),l(3),f("ngIf",n.mostrarFormulario),l(),f("ngIf",n.editingCita),l(),f("ngIf",n.citaAEliminar),l(),f("ngIf",n.loading),l(),f("ngIf",n.successMessage),l(),f("ngIf",n.editMessage),l(),f("ngIf",n.deleteMessage),l(),f("ngIf",!n.loading))},dependencies:[H,xt,ne,_e,It,Mn,Nn,On,wt,Tn,Et,In,Pn,St,kn,vn],encapsulation:2})};function El(i,t){i&1&&(o(0,"div",9),c(1," \u23F3 Cargando pacientes... "),a())}function Sl(i,t){if(i&1&&(o(0,"tr",24)(1,"td",25),c(2),a(),o(3,"td",25),c(4),a(),o(5,"td",26),c(6),a(),o(7,"td",26),c(8),a(),o(9,"td",26),c(10),a(),o(11,"td",26),c(12),a(),o(13,"td",26),c(14),a()()),i&2){let e=t.$implicit;l(2),y(e.nombres),l(2),y(e.apellidos),l(2),y(e.dni),l(2),y(e.fechaNacimiento),l(2),y(e.direccion),l(2),y(e.telefono),l(2),y(e.email)}}function Il(i,t){if(i&1&&(o(0,"div",17)(1,"div",18)(2,"table",19)(3,"thead",20)(4,"tr")(5,"th",21),c(6,"Nombres"),a(),o(7,"th",21),c(8,"Apellidos"),a(),o(9,"th",21),c(10,"DNI"),a(),o(11,"th",21),c(12,"Edad"),a(),o(13,"th",21),c(14,"Direcci\xF3n"),a(),o(15,"th",21),c(16,"Tel\xE9fono"),a(),o(17,"th",21),c(18,"Correo"),a()()(),o(19,"tbody",22),S(20,Sl,15,7,"tr",23),a()()()()),i&2){let e=h(3);l(20),f("ngForOf",e.pacientes)}}function kl(i,t){if(i&1&&(o(0,"div",29)(1,"div",30)(2,"h3",31),c(3),a(),o(4,"span",32),c(5),a()(),o(6,"p",33)(7,"b"),c(8,"DNI:"),a(),c(9),a(),o(10,"p",33)(11,"b"),c(12,"Tel\xE9fono:"),a(),c(13),a(),o(14,"p",33)(15,"b"),c(16,"Email:"),a(),c(17),a(),o(18,"p",33)(19,"b"),c(20,"Direcci\xF3n:"),a(),c(21),a()()),i&2){let e=t.$implicit;l(3),y(e.nombres),l(2),E(" ",e.fechaNacimiento," a\xF1os "),l(4),E(" ",e.dni),l(4),E(" ",e.telefono),l(4),E(" ",e.email),l(4),E(" ",e.direccion)}}function Ml(i,t){if(i&1&&(o(0,"div",27),S(1,kl,22,6,"div",28),a()),i&2){let e=h(3);l(),f("ngForOf",e.pacientes)}}function Tl(i,t){if(i&1){let e=k();o(0,"div"),S(1,Il,21,1,"div",11)(2,Ml,2,1,"div",12),o(3,"div",13)(4,"button",14),x("click",function(){b(e);let r=h(2);return v(r.prevPage())}),c(5," \u2B05 Anterior "),a(),o(6,"span",15),c(7),a(),o(8,"button",16),x("click",function(){b(e);let r=h(2);return v(r.nextPage())}),c(9," Siguiente \u27A1 "),a()()()}if(i&2){let e=h(2);l(),f("ngIf",e.viewMode==="table"),l(),f("ngIf",e.viewMode==="cards"),l(2),f("disabled",e.currentPage===0),l(3),K(" P\xE1gina ",e.currentPage+1," de ",e.totalPages," "),l(),f("disabled",e.currentPage>=e.totalPages-1)}}function Nl(i,t){if(i&1&&S(0,Tl,10,6,"div",10),i&2){let e=h(),n=gt(12);f("ngIf",e.pacientes.length>0)("ngIfElse",n)}}function Ol(i,t){i&1&&(o(0,"div",34)(1,"p",35),c(2,"No hay pacientes registrados \u{1F5D2}\uFE0F"),a(),o(3,"p",36),c(4,"Puedes agregar un nuevo paciente desde el bot\xF3n "),o(5,"b"),c(6,"\u201C+ Nuevo Paciente\u201D"),a(),c(7,"."),a()())}var ri=class i{constructor(t,e){this.pacienteService=t;this.cdr=e}pacientes=[];totalPages=0;currentPage=0;size=10;loading=!1;viewMode="table";ngOnInit(){this.loadPacientes()}loadPacientes(t=0){this.loading=!0,this.pacienteService.getPacientes(t,this.size).subscribe({next:e=>{this.pacientes=e.content,this.totalPages=e.totalPages??0,this.currentPage=e.number??0,this.loading=!1,this.cdr.detectChanges()},error:e=>{console.error("Error cargando pacientes",e),this.loading=!1}})}prevPage(){this.currentPage>0&&this.loadPacientes(this.currentPage-1)}nextPage(){this.currentPage<this.totalPages-1&&this.loadPacientes(this.currentPage+1)}toggleView(){this.viewMode=this.viewMode==="table"?"cards":"table"}static \u0275fac=function(e){return new(e||i)(O($e),O(ve))};static \u0275cmp=D({type:i,selectors:[["app-paciente"]],decls:13,vars:3,consts:[["emptyTpl",""],[1,"container","mx-auto","px-6","py-8"],[1,"flex","items-center","justify-between","mb-6"],[1,"text-3xl","font-extrabold","text-gray-800","tracking-tight"],[1,"flex","gap-3"],[1,"px-4","py-2","bg-indigo-600","hover:bg-indigo-700","text-white","text-sm","font-medium","rounded-xl","shadow-md","transition",3,"click"],[1,"px-4","py-2","bg-blue-600","hover:bg-blue-700","text-white","text-sm","font-medium","rounded-xl","shadow-md","transition"],["class","text-center text-gray-500 py-10",4,"ngIf"],[3,"ngIf"],[1,"text-center","text-gray-500","py-10"],[4,"ngIf","ngIfElse"],["class","bg-white/70 backdrop-blur-lg rounded-2xl shadow-lg overflow-hidden border border-gray-100",4,"ngIf"],["class","grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",4,"ngIf"],[1,"flex","justify-between","items-center","p-4","mt-6","bg-gray-50","border","rounded-xl"],[1,"flex","items-center","gap-2","px-4","py-2","bg-gray-200","hover:bg-gray-300","rounded-xl","text-sm","font-medium","transition","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],[1,"text-gray-600","font-medium"],[1,"flex","items-center","gap-2","px-4","py-2","bg-green-600","hover:bg-green-700","text-white","rounded-xl","text-sm","font-medium","shadow-md","transition","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],[1,"bg-white/70","backdrop-blur-lg","rounded-2xl","shadow-lg","overflow-hidden","border","border-gray-100"],[1,"overflow-x-auto"],[1,"w-full","text-sm","text-left","text-gray-700"],[1,"bg-gradient-to-r","from-green-600","to-green-500","text-white","uppercase","text-xs","tracking-wider"],[1,"px-6","py-3"],[1,"divide-y","divide-gray-200"],["class","hover:bg-gray-50 transition",4,"ngFor","ngForOf"],[1,"hover:bg-gray-50","transition"],[1,"px-6","py-4","font-medium","text-gray-900"],[1,"px-6","py-4"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-3","gap-6"],["class","bg-white rounded-2xl shadow-lg border border-gray-200 p-6 hover:shadow-xl transition",4,"ngFor","ngForOf"],[1,"bg-white","rounded-2xl","shadow-lg","border","border-gray-200","p-6","hover:shadow-xl","transition"],[1,"flex","justify-between","items-center","mb-4"],[1,"text-lg","font-bold","text-gray-800"],[1,"bg-green-100","text-green-700","px-3","py-1","rounded-full","text-xs","font-semibold"],[1,"text-sm","text-gray-600"],[1,"text-center","text-gray-500","mt-10","bg-gray-100","py-10","rounded-xl","shadow-inner"],[1,"text-lg","font-medium"],[1,"text-sm"]],template:function(e,n){if(e&1){let r=k();o(0,"div",1)(1,"div",2)(2,"h2",3),c(3," \u{1F9D1}\u200D\u2695\uFE0F Pacientes "),a(),o(4,"div",4)(5,"button",5),x("click",function(){return b(r),v(n.toggleView())}),c(6),a(),o(7,"button",6),c(8," + Nuevo Paciente "),a()()(),S(9,El,2,0,"div",7)(10,Nl,1,2,"ng-template",8)(11,Ol,8,0,"ng-template",null,0,_t),a()}e&2&&(l(6),E(" Cambiar a ",n.viewMode==="table"?"Cards":"Tabla"," "),l(3),f("ngIf",n.loading),l(),f("ngIf",!n.loading))},dependencies:[H,ne,_e],encapsulation:2})};var oi=class i{constructor(t){this.http=t}_httpClient=V(W);baseUrl=q.apiUrl;getEspecialidades(t=0,e=6){return this._httpClient.get(`${this.baseUrl}/api/especialidades?page=${t}&size=${e}`).pipe(dn(n=>n.content))}static \u0275fac=function(e){return new(e||i)(ht(W))};static \u0275prov=Z({token:i,factory:i.\u0275fac,providedIn:"root"})};function Dl(i,t){i&1&&(o(0,"div",9)(1,"span",10),c(2,"Cargando especialidades..."),a()())}function Al(i,t){if(i&1&&(o(0,"tr",17)(1,"td",18),c(2),a(),o(3,"td",19),c(4),a(),o(5,"td",20),c(6),a()()),i&2){let e=t.$implicit;l(2),y(e.id),l(2),y(e.nombre),l(2),y(e.descripcion)}}function ql(i,t){if(i&1&&(o(0,"div",11)(1,"table",12)(2,"thead",13)(3,"tr")(4,"th",14),c(5,"ID"),a(),o(6,"th",14),c(7,"Nombre"),a(),o(8,"th",14),c(9,"Descripci\xF3n"),a()()(),o(10,"tbody",15),S(11,Al,7,3,"tr",16),a()()()),i&2){let e=h();l(11),f("ngForOf",e.especialidades)}}function Vl(i,t){i&1&&(o(0,"div",21),c(1," No hay especialidades registradas. "),a())}function Rl(i,t){if(i&1){let e=k();o(0,"div",22)(1,"button",23),x("click",function(){b(e);let r=h();return v(r.prevPage())}),c(2," Anterior "),a(),o(3,"span",24),c(4),a(),o(5,"button",23),x("click",function(){b(e);let r=h();return v(r.nextPage())}),c(6," Siguiente "),a()()}if(i&2){let e=h();l(),f("disabled",e.currentPage===0),l(3),K(" P\xE1gina ",e.currentPage+1," de ",e.totalPages," "),l(),f("disabled",e.currentPage>=e.totalPages-1)}}var ai=class i{constructor(t,e){this.especialidadService=t;this.cdr=e}especialidades=[];totalPages=0;currentPage=0;size=6;loading=!1;ngOnInit(){this.loadEspecialidades()}loadEspecialidades(t=0){this.loading=!0,this.especialidadService.getEspecialidades(t,this.size).subscribe({next:e=>{this.especialidades=e,this.totalPages=e.totalPages??0,this.currentPage=e.number??0,this.loading=!1,this.cdr.detectChanges()},error:e=>{console.error("Error cargando especialidades",e),this.loading=!1}})}prevPage(){this.currentPage>0&&this.loadEspecialidades(this.currentPage-1)}nextPage(){this.currentPage<this.totalPages-1&&this.loadEspecialidades(this.currentPage+1)}static \u0275fac=function(e){return new(e||i)(O(oi),O(ve))};static \u0275cmp=D({type:i,selectors:[["app-especialidad"]],decls:11,vars:4,consts:[[1,"p-6"],[1,"flex","items-center","justify-between","mb-6"],[1,"text-3xl","font-extrabold","text-gray-800","tracking-tight"],[1,"flex","gap-3"],[1,"px-4","py-2","bg-gradient-to-r","from-green-500","to-teal-500","hover:from-green-600","hover:to-teal-600","text-white","text-sm","font-medium","rounded-xl","shadow-md","transition"],["class","text-center py-6",4,"ngIf"],["class","overflow-x-auto bg-white shadow rounded-xl",4,"ngIf"],["class","text-center py-6 text-gray-500",4,"ngIf"],["class","flex justify-between items-center mt-6",4,"ngIf"],[1,"text-center","py-6"],[1,"text-green-600","font-medium"],[1,"overflow-x-auto","bg-white","shadow","rounded-xl"],[1,"min-w-full","divide-y","divide-gray-200"],[1,"bg-gradient-to-r","from-green-500","to-teal-500","text-white"],[1,"px-6","py-3","text-left","text-sm","font-medium","uppercase","tracking-wider"],[1,"divide-y","divide-gray-100"],["class","hover:bg-green-50",4,"ngFor","ngForOf"],[1,"hover:bg-green-50"],[1,"px-6","py-4","text-sm","text-gray-700"],[1,"px-6","py-4","text-sm","font-medium","text-gray-900"],[1,"px-6","py-4","text-sm","text-gray-600"],[1,"text-center","py-6","text-gray-500"],[1,"flex","justify-between","items-center","mt-6"],[1,"px-4","py-2","rounded-lg","bg-gradient-to-r","from-green-500","to-teal-500","text-white","hover:from-green-600","hover:to-teal-600","disabled:opacity-50",3,"click","disabled"],[1,"text-sm","text-gray-600"]],template:function(e,n){e&1&&(o(0,"div",0)(1,"div",1)(2,"h2",2),c(3," \u{1F3E5} Especialidades "),a(),o(4,"div",3)(5,"button",4),c(6," + Nueva Especialidad "),a()()(),S(7,Dl,3,0,"div",5)(8,ql,12,1,"div",6)(9,Vl,2,0,"div",7)(10,Rl,7,4,"div",8),a()),e&2&&(l(7),f("ngIf",n.loading),l(),f("ngIf",!n.loading&&n.especialidades.length>0),l(),f("ngIf",!n.loading&&n.especialidades.length===0),l(),f("ngIf",n.totalPages>1))},dependencies:[H,ne,_e],encapsulation:2})};function Ll(i,t){i&1&&(o(0,"div",8)(1,"span",9),c(2,"Cargando m\xE9dicos..."),a()())}function jl(i,t){if(i&1&&(o(0,"tr",16)(1,"td",17),c(2),a(),o(3,"td",18),c(4),a(),o(5,"td",19),c(6),a(),o(7,"td",19),c(8),a()()),i&2){let e=t.$implicit;l(2),y(e.apellidos),l(2),y(e.nombres),l(2),y(e.cmp),l(2),y(e.especialidad.nombre)}}function Fl(i,t){if(i&1&&(o(0,"div",10)(1,"table",11)(2,"thead",12)(3,"tr")(4,"th",13),c(5,"Apellidos"),a(),o(6,"th",13),c(7,"Nombres"),a(),o(8,"th",13),c(9,"CMP"),a(),o(10,"th",13),c(11,"Especialidad"),a()()(),o(12,"tbody",14),S(13,jl,9,4,"tr",15),a()()()),i&2){let e=h();l(13),f("ngForOf",e.medicos)}}function Hl(i,t){i&1&&(o(0,"div",20),c(1," No hay m\xE9dicos registrados. "),a())}function Wl(i,t){if(i&1){let e=k();o(0,"div",21)(1,"button",22),x("click",function(){b(e);let r=h();return v(r.prevPage())}),c(2," Anterior "),a(),o(3,"span",23),c(4),a(),o(5,"button",22),x("click",function(){b(e);let r=h();return v(r.nextPage())}),c(6," Siguiente "),a()()}if(i&2){let e=h();l(),f("disabled",e.currentPage===0),l(3),K(" P\xE1gina ",e.currentPage+1," de ",e.totalPages," "),l(),f("disabled",e.currentPage>=e.totalPages-1)}}var si=class i{constructor(t,e){this.medicoService=t;this.cdr=e}medicos=[];totalPages=0;currentPage=0;size=10;loading=!1;ngOnInit(){this.loadMedicos()}loadMedicos(t=0){this.loading=!0,this.medicoService.getMedicos(t,this.size).subscribe({next:e=>{this.medicos=e.content,this.totalPages=e.totalPages??0,this.currentPage=e.number??0,this.loading=!1,this.cdr.detectChanges()},error:e=>{console.error("Error cargando m\xE9dicos",e),this.loading=!1}})}prevPage(){this.currentPage>0&&this.loadMedicos(this.currentPage-1)}nextPage(){this.currentPage<this.totalPages-1&&this.loadMedicos(this.currentPage+1)}static \u0275fac=function(e){return new(e||i)(O(ze),O(ve))};static \u0275cmp=D({type:i,selectors:[["app-medico"]],decls:10,vars:4,consts:[[1,"p-6"],[1,"flex","items-center","justify-between","mb-6"],[1,"text-3xl","font-extrabold","text-red-800","tracking-tight"],[1,"px-4","py-2","bg-gradient-to-r","from-red-600","to-red-500","hover:from-red-700","hover:to-red-600","text-white","text-sm","font-medium","rounded-xl","shadow-md","transition"],["class","text-center py-6",4,"ngIf"],["class","overflow-x-auto bg-white shadow rounded-xl",4,"ngIf"],["class","text-center py-6 text-red-500",4,"ngIf"],["class","flex justify-between items-center mt-6",4,"ngIf"],[1,"text-center","py-6"],[1,"text-red-600","font-medium"],[1,"overflow-x-auto","bg-white","shadow","rounded-xl"],[1,"min-w-full","divide-y","divide-gray-200"],[1,"bg-gradient-to-r","from-red-600","to-red-500","text-white"],[1,"px-6","py-3","text-left","text-sm","font-medium","uppercase","tracking-wider"],[1,"divide-y","divide-gray-100"],["class","hover:bg-red-50",4,"ngFor","ngForOf"],[1,"hover:bg-red-50"],[1,"px-6","py-4","text-sm","text-red-900"],[1,"px-6","py-4","text-sm","font-medium","text-red-900"],[1,"px-6","py-4","text-sm","text-red-700"],[1,"text-center","py-6","text-red-500"],[1,"flex","justify-between","items-center","mt-6"],[1,"px-4","py-2","rounded-lg","bg-gradient-to-r","from-red-600","to-red-500","text-white","hover:from-red-700","hover:to-red-600","disabled:opacity-50",3,"click","disabled"],[1,"text-sm","text-red-700"]],template:function(e,n){e&1&&(o(0,"div",0)(1,"div",1)(2,"h2",2),c(3," \u{1F468}\u200D\u2695\uFE0F M\xE9dicos "),a(),o(4,"button",3),c(5," + Nuevo M\xE9dico "),a()(),S(6,Ll,3,0,"div",4)(7,Fl,14,1,"div",5)(8,Hl,2,0,"div",6)(9,Wl,7,4,"div",7),a()),e&2&&(l(6),f("ngIf",n.loading),l(),f("ngIf",!n.loading&&n.medicos.length>0),l(),f("ngIf",!n.loading&&n.medicos.length===0),l(),f("ngIf",n.totalPages>1))},dependencies:[H,ne,_e],encapsulation:2})};var Ia=[{path:"",component:ei,canActivate:[Ca],children:[{path:"",pathMatch:"full",redirectTo:"dashboard"},{path:"dashboard",component:ti},{path:"citas",component:ni},{path:"pacientes",component:ri},{path:"especialidades",component:ai},{path:"medicos",component:si}]},{path:"auth",loadChildren:()=>import("./chunk-H7EJSGCH.js").then(i=>i.AUTH_ROUTES)},{path:"**",redirectTo:""}];var ka=(i,t)=>{let e=localStorage.getItem("accessToken");if(e&&!i.headers.has("Authorization")){let n=i.clone({setHeaders:{Authorization:`Bearer ${e}`}});return t(n)}return t(i)};var Ma={providers:[mn(),gn(),En(Ia),xn(yn([ka]))]};var Ta=ln(an());var ci=class i{client;notificacion=M(null);connect(){this.client=new Ve({webSocketFactory:()=>new Ta.default(`${q.apiUrl}/ws`),reconnectDelay:5e3}),this.client.onConnect=()=>{this.client.subscribe("/topic/notificaciones",t=>{let e=JSON.parse(t.body);this.notificacion.set(e),setTimeout(()=>this.notificacion.set(null),2e3)})},this.client.activate()}static \u0275fac=function(e){return new(e||i)};static \u0275prov=Z({token:i,factory:i.\u0275fac,providedIn:"root"})};function Bl(i,t){if(i&1&&(o(0,"div",0),c(1),a()),i&2){let e,n=h();l(),E(" ",(e=n.ws.notificacion())==null?null:e.mensaje," ")}}var li=class i{constructor(t){this.ws=t}title=M("LENIN");ngOnInit(){this.ws.connect()}static \u0275fac=function(e){return new(e||i)(O(ci))};static \u0275cmp=D({type:i,selectors:[["app-root"]],decls:2,vars:1,consts:[[1,"fixed","top-6","left-6","z-50","bg-green-600","text-white","px-4","py-3","rounded-xl","shadow-lg"]],template:function(e,n){e&1&&($(0,Bl,2,1,"div",0),I(1,"router-outlet")),e&2&&z(n.ws.notificacion()?0:-1)},dependencies:[yt],encapsulation:2})};globalThis.global=globalThis;_n(li,Ma).catch(i=>console.error(i));
